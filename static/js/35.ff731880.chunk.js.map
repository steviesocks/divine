{"version":3,"sources":["../node_modules/@arcgis/core/core/CircularArray.js","../node_modules/@arcgis/core/views/2d/layers/features/FeatureStore2D.js","../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFIndirect.js","../node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js","../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js"],"names":["s","t","Number","POSITIVE_INFINITY","this","size","_start","maxSize","_buffer","isFinite","Array","i","dequeue","h","e","c","I","u","getObjectId","getAttributes","readAttributes","getAttribute","readAttribute","cloneWithGeometry","getGeometry","readHydratedGeometry","getCentroid","readCentroid","l","a","r","featureAdapter","events","_featureSetsByInstance","Map","_objectIdToDisplayId","_spatialIndexInvalid","_indexSearchCache","_index","n","minX","_storage","getXMin","minY","getYMin","maxX","getXMax","maxY","getYMax","mode","featureCount","vertexCount","has","addOrUpdate","attachStorage","getCursor","next","getDisplayId","setComputedAttributes","scale","set","instance","_insertFeature","emit","_rebuildIndex","id","find","tileId","readers","_searchIndex","bounds","getInstanceId","get","push","forEach","d","from","enqueue","getIndex","createDisplayId","setDisplayId","setInstanceId","delete","releaseDisplayId","removeAtIndex","isEmpty","_lookupFeature","_getFeatureSet","setIndex","lookupFeatureByDisplayId","readGeometry","unsetAttributeData","search","setBounds","clear","load","o","createInstance","_currentIndex","_reader","_indices","length","copy","_nextIndex","_getExists","setArcadeSpatialReference","geometryType","hasFeatures","exceededTransferLimit","hasZ","hasM","getStorage","getComputedNumericAtIndex","setComputedNumericAtIndex","getComputedStringAtIndex","setComputedStringAtIndex","transform","joinAttributes","readArcadeFeature","geometry","hasField","setField","keys","castToText","getQuantizationTransform","getAttributeHash","getGroupId","setGroupId","getXHydrate","getYHydrate","getX","getY","readLegacyFeature","readOptimizedFeature","readLegacyPointGeometry","readLegacyGeometry","readLegacyCentroid","readGeometryArea","readUnquantizedGeometry","Error","referencesGeometry","evaluate","$feature","getLogger","warn","_canCacheExpressionValue","_sourceInfo","_bitsets","computed","getBitset","createBitset","_schema","console","debug","targets","name","attributes","type","_createArcadeComputedField","_createLabelArcadeComputedField","Promise","all","_computedFields","some","expression","referencesScale","_statisticFields","_evaluateField","resultType","fieldIndex","spatialReference","fieldsIndex","valueExpression","createLabelFunction","label","builder","$view"],"mappings":"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","file":"static/js/35.ff731880.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"./maybe.js\";class s{constructor(t=Number.POSITIVE_INFINITY){this.size=0,this._start=0,this.maxSize=t,this._buffer=isFinite(t)?new Array(t):[]}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=t:this._buffer[this._start+this.size++]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(s){if(0===this.size)return null;for(const i of this._buffer)if(t(i)&&s(i))return i;return null}clear(s){let i=this.dequeue();for(;t(i);)s&&s(i),i=this.dequeue()}}export default s;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/CircularArray.js\";import e from\"../../../../core/Evented.js\";import\"../../../../core/has.js\";import{isNone as s,isSome as a,unwrap as r}from\"../../../../core/maybe.js\";import{r as n}from\"../../../../chunks/rbush.js\";import{fromRect as i}from\"../../../../geometry/support/aaBoundingBox.js\";import{Store2D as o}from\"./Store2D.js\";import{FeatureSetReaderIndirect as d}from\"./support/FeatureSetReaderPBFIndirect.js\";function h(t,e){return t<<16|e}function c(t){return(4294901760&t)>>>16}function I(t){return 65535&t}const u={getObjectId:t=>t.getObjectId(),getAttributes:t=>t.readAttributes(),getAttribute:(t,e)=>t.readAttribute(e),cloneWithGeometry:(t,e)=>t,getGeometry:t=>t.readHydratedGeometry(),getCentroid:(t,e)=>t.readCentroid()};class l extends o{constructor(s,a,r){super(s,a),this.featureAdapter=u,this.events=new e,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new t(50),this._index=n(9,(t=>({minX:this._storage.getXMin(t),minY:this._storage.getYMin(t),maxX:this._storage.getXMax(t),maxY:this._storage.getYMax(t)}))),this._storage=a,this.mode=r}get storage(){return this._storage}get storeStatistics(){return{featureCount:0,vertexCount:0}}hasInstance(t){return this._featureSetsByInstance.has(t)}onTileData(t,e){if(s(e.addOrUpdate))return e;if(e.addOrUpdate.attachStorage(this._storage),\"snapshot\"===this.mode){const s=e.addOrUpdate.getCursor();for(;s.next();){const e=s.getDisplayId();this.setComputedAttributes(this._storage,s,e,t.scale)}return e}this._featureSetsByInstance.set(e.addOrUpdate.instance,e.addOrUpdate);const a=e.addOrUpdate.getCursor();for(;a.next();)this._insertFeature(a,t.scale);return this._spatialIndexInvalid=!0,this.events.emit(\"changed\"),e}search(t){this._rebuildIndex();const e=t.id,s=this._indexSearchCache.find((t=>t.tileId===e));if(a(s))return s.readers;const r=new Map,n=this._searchIndex(t.bounds),i=[];for(const a of n){const t=this._storage.getInstanceId(a),e=c(t),s=I(t);r.has(e)||r.set(e,[]);r.get(e).push(s)}return r.forEach(((t,e)=>{const s=this._featureSetsByInstance.get(e);i.push(d.from(s,t))})),this._indexSearchCache.enqueue({tileId:e,readers:i}),i}insert(t){const e=t.getCursor(),s=this._storage;for(;e.next();){var a;const t=h(e.instance,e.getIndex()),r=e.getObjectId(),n=null!=(a=this._objectIdToDisplayId.get(r))?a:this._storage.createDisplayId();e.setDisplayId(n),s.setInstanceId(n,t),this._objectIdToDisplayId.set(r,n)}this._featureSetsByInstance.set(t.instance,t),this._spatialIndexInvalid=!0}remove(t){const e=this._objectIdToDisplayId.get(t);if(!e)return;const s=this._storage.getInstanceId(e),a=I(s),r=c(s),n=this._featureSetsByInstance.get(r);this._objectIdToDisplayId.delete(t),this._storage.releaseDisplayId(e),n.removeAtIndex(a),n.isEmpty&&this._featureSetsByInstance.delete(r),this._spatialIndexInvalid=!0}forEach(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=this._lookupFeature(s);t(a)}))}forEachUnsafe(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=c(s),r=I(s),n=this._getFeatureSet(a);n.setIndex(r),t(n)}))}forEachInBounds(t,e){const s=this._searchIndex(t);for(const a of s){const t=this.lookupFeatureByDisplayId(a,this._storage);e(r(t))}}forEachBounds(t,e,s){this._rebuildIndex();const a=[0,0,0,0];for(const r of t){if(!r.readGeometry())continue;const t=r.getDisplayId();a[0]=this._storage.getXMin(t),a[1]=this._storage.getYMin(t),a[2]=this._storage.getXMax(t),a[3]=this._storage.getYMax(t),e(i(s,a))}}sweepFeatures(t,e,s){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach(((a,r)=>{t.has(a)||(e.releaseDisplayId(a),s&&s.unsetAttributeData(a),this._objectIdToDisplayId.delete(r))})),this.events.emit(\"changed\")}sweepFeatureSets(t){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach(((e,s)=>{t.has(s)||this._featureSetsByInstance.delete(s)}))}lookupObjectId(t,e){const a=this.lookupFeatureByDisplayId(t,e);return s(a)?null:a.getObjectId()}lookupDisplayId(t){return this._objectIdToDisplayId.get(t)}lookupFeatureByDisplayId(t,e){const s=e.getInstanceId(t);return this._lookupFeature(s)}lookupByDisplayIdUnsafe(t){const e=this._storage.getInstanceId(t),s=c(e),a=I(e),r=this._getFeatureSet(s);return r?(r.setIndex(a),r):null}_insertFeature(t,e){const s=this._storage,a=t.getObjectId(),r=h(t.instance,t.getIndex());s.getInstanceId(t.getDisplayId());let n=this._objectIdToDisplayId.get(a);n||(n=s.createDisplayId(),this._objectIdToDisplayId.set(a,n),this._spatialIndexInvalid=!0),t.setDisplayId(n),s.setInstanceId(n,r),this.setComputedAttributes(s,t,n,e)}_searchIndex(t){this._rebuildIndex();const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._index.search(e)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const t=[];\"snapshot\"===this.mode?this._featureSetsByInstance.forEach((e=>{const s=e.getCursor();for(;s.next();){const e=s.getDisplayId();this._storage.setBounds(e,s)&&t.push(e)}})):this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e);this._storage.setBounds(e,this._lookupFeature(s))&&t.push(e)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(t){const e=c(t),s=I(t),a=this._getFeatureSet(e);if(!a)return null;const r=a.getCursor();return r.setIndex(s),r}_getFeatureSet(t){return this._featureSetsByInstance.get(t)}}export{l as FeatureStore2D,u as featureAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{FeatureSetReader as e}from\"./FeatureSetReader.js\";class r extends e{constructor(r,t){super(e.createInstance()),this._currentIndex=-1,this._reader=r,this._indices=t}static from(e,t){return new r(e.copy(),t)}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(e){this._reader.setArcadeSpatialReference(e)}attachStorage(e){this._reader.attachStorage(e)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(e){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(e,r){return this._reader.setComputedNumericAtIndex(r,0)}getComputedString(e){return this._reader.getComputedStringAtIndex(0)}setComputedString(e,r){return this._reader.setComputedStringAtIndex(0,r)}getComputedNumericAtIndex(e){return this._reader.getComputedNumericAtIndex(e)}setComputedNumericAtIndex(e,r){this._reader.setComputedNumericAtIndex(e,r)}getComputedStringAtIndex(e){return this._reader.getComputedStringAtIndex(e)}setComputedStringAtIndex(e,r){return this._reader.setComputedStringAtIndex(e,r)}transform(e,r,t,d){const a=this.copy();return a._reader=this._reader.transform(e,r,t,d),a}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this.readAttribute(e,!0)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(){return this._reader.castToText()}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}getGroupId(){return this._reader.getGroupId()}setGroupId(e){return this._reader.setGroupId(e)}getXHydrate(){return this._reader.getXHydrate()}getYHydrate(){return this._reader.getYHydrate()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_readAttribute(e,r){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}_readAttributes(){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}}export{r as FeatureSetReaderIndirect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";function r(r,a,t){r.referencesGeometry();const n=a.readArcadeFeature();try{return r.evaluate({...t,$feature:n})}catch(o){return e.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\",o),null}}export default r;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/has.js\";import{isNone as s}from\"../../../../core/maybe.js\";import{diff as t,hasDiff as i}from\"../../../../core/accessorSupport/diffUtils.js\";import{createRendererExpression as a}from\"../../../../support/arcadeOnDemand.js\";import r from\"../../arcade/callExpressionWithCursor.js\";const c=import(\"../../../../layers/support/labelFormatUtils.js\");class o{constructor(e,s){this._canCacheExpressionValue=!1,this._sourceInfo=e,this._bitsets={computed:s.getBitset(s.createBitset())}}invalidate(){this._bitsets.computed.clear()}async updateSchema(a,r){const c=t(this._schema,r);if(this._schema=r,!r||s(c)||!i(c,\"attributes\"))return;e(\"esri-2d-update-debug\")&&console.debug(\"Applying Update - Store:\",c),this._bitsets.computed.clear(),a.targets[r.name]=!0;const o=r.attributes,n=[],d=[];for(const e in o){const s=o[e];switch(s.type){case\"field\":break;case\"expression\":n.push(this._createArcadeComputedField(s));break;case\"label-expression\":n.push(this._createLabelArcadeComputedField(s));break;case\"statistic\":d.push(s)}}this._computedFields=await Promise.all(n),this._canCacheExpressionValue=!this._computedFields.some((e=>\"expression\"===e.type&&e.expression.referencesScale())),this._statisticFields=d}setComputedAttributes(e,s,t,i){const a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(t)){a.set(t);for(const a of this._computedFields){const r=this._evaluateField(s,a,i);switch(a.resultType){case\"numeric\":e.setComputedNumericAtIndex(t,a.fieldIndex,r);break;case\"string\":e.setComputedStringAtIndex(t,a.fieldIndex,r)}}}}async _createArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fieldsIndex;return{...e,expression:await a(e.valueExpression,s,t)}}async _createLabelArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fieldsIndex,{createLabelFunction:i}=await c,a=await i(e.label,t,s);return{...e,builder:a}}_evaluateField(e,s,t){switch(s.type){case\"label-expression\":{const t=e.readArcadeFeature();return s.builder.evaluate(t)||\"\"}case\"expression\":{const{expression:i}=s;return r(i,e,{$view:{scale:t}})}}}}export{o as Store2D};\n"],"sourceRoot":""}