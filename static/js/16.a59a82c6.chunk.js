(this.webpackJsonpdivine=this.webpackJsonpdivine||[]).push([[16],{671:function(e,t,r){"use strict";function n(){return[0,0,0,0]}function a(e,t,r,n){return[e,t,r,n]}function u(e,t){return new Float64Array(e,t,4)}function s(){return[0,0,0,0]}function i(){return a(1,1,1,1)}function o(){return a(1,0,0,0)}function c(){return a(0,1,0,0)}function f(){return a(0,0,1,0)}function p(){return a(0,0,0,1)}r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var d=[0,0,0,0],l=i(),h=o(),b=c(),m=f(),v=p();Object.freeze({__proto__:null,create:n,clone:function(e){return[e[0],e[1],e[2],e[3]]},fromValues:a,fromArray:function(e){for(var t=[0,0,0,0],r=Math.min(4,e.length),n=0;n<r;++n)t[n]=e[n];return t},createView:u,zeros:s,ones:i,unitX:o,unitY:c,unitZ:f,unitW:p,ZEROS:d,ONES:l,UNIT_X:h,UNIT_Y:b,UNIT_Z:m,UNIT_W:v})},688:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s}));r(10);function n(e){switch(e){case"u8":return 1;case"u16":return 2;case"u32":return 4;case"i8":return 1;case"i16":return 2;case"i32":case"f32":return 4;case"f64":return 8;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function u(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function s(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},731:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r(688);function a(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,i=r?r.count:t.count,o=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*s,f=0;f<i;++f)n[o]=u[c],n[o+1]=u[c+1],o+=a,c+=s}function u(e,t,r){var u=e.typedBuffer,s=e.typedBufferStride,i=t.typedBuffer,o=t.typedBufferStride,c=r?r.count:t.count,f=(r&&r.dstIndex?r.dstIndex:0)*s,p=(r&&r.srcIndex?r.srcIndex:0)*o;if(Object(n.b)(t.elementType)){var d=Object(n.d)(t.elementType);if(Object(n.c)(t.elementType))for(var l=0;l<c;++l)u[f]=Math.max(i[p]/d,-1),u[f+1]=Math.max(i[p+1]/d,-1),f+=s,p+=o;else for(var h=0;h<c;++h)u[f]=i[p]/d,u[f+1]=i[p+1]/d,f+=s,p+=o}else a(e,t,r);return e}function s(e,t,r,n){for(var a,u,s=e.typedBuffer,i=e.typedBufferStride,o=null!=(a=null==n?void 0:n.count)?a:e.count,c=(null!=(u=null==n?void 0:n.dstIndex)?u:0)*i,f=0;f<o;++f)s[c]=t,s[c+1]=r,c+=i}Object.freeze({__proto__:null,copy:a,normalizeIntegerBuffer:u,fill:s})},732:function(e,t,r){"use strict";function n(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,i=r?r.count:t.count,o=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*s,f=0;f<i;++f)n[o]=u[c],n[o+1]=u[c+1],n[o+2]=u[c+2],n[o+3]=u[c+3],o+=a,c+=s}function a(e,t,r,n,a,u){for(var s,i,o=e.typedBuffer,c=e.typedBufferStride,f=null!=(s=null==u?void 0:u.count)?s:e.count,p=(null!=(i=null==u?void 0:u.dstIndex)?i:0)*c,d=0;d<f;++d)o[p]=t,o[p+1]=r,o[p+2]=n,o[p+3]=a,p+=c}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));Object.freeze({__proto__:null,copy:n,fill:a})},744:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return b}));var n=r(2),a=r(3),u=r(8),s=r(346),i=r(582),o=r(603),c=r(616),f=r(76),p=r(86),d=r(671),l=function(){function e(t,r,a){var u=this;Object(n.a)(this,e),this.itemByteSize=t,this.itemCreate=r,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(a/this.itemByteSize),this.tickHandle=s.a.before((function(){return u.reset()}))}return Object(a.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(u.m)(this.tickHandle)),this.itemsPtr=0,this.items=Object(u.m)(this.items),this.buffers=Object(u.m)(this.buffers)}},{key:"get",value:function(){0===this.itemsPtr&&Object(s.a)((function(){}));for(var e=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=e;){for(var t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),r=0;r<this.itemsPerBuffer;++r)this.items.push(this.itemCreate(t,r*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}},{key:"reset",value:function(){for(var e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}},{key:"test",get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(16,f.b,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(24,p.d,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(32,d.a,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(72,i.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(128,o.b,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return new e(32,c.d,t)}}]),e}(),h=4096,b=(l.createVec2f64(),l.createVec3f64()),m=(l.createVec4f64(),l.createMat3f64(),l.createMat4f64());l.createQuatf64()},792:function(e,t,r){"use strict";function n(e,t){var r=e.count;t||(t=new e.TypedArrayConstructor(r));for(var n=0;n<r;n++)t[n]=e.get(n);return t}r.d(t,"a",(function(){return n}));Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,i=r?r.count:t.count,o=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*s,f=0;f<i;++f)n[o]=u[c],o+=a,c+=s},makeDense:n})},793:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2),a=r(3),u=r(8),s=r(346),i=function(){function e(t){var r=this;Object(n.a)(this,e),this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=s.a.before((function(){return r.reset()})),this.grow()}return Object(a.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(u.m)(this.tickHandle)),this.items=Object(u.m)(this.items)}},{key:"get",value:function(){return 0===this.itemsPtr&&Object(s.a)((function(){})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}},{key:"reset",value:function(){var e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*o);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0}},{key:"grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this.items.length,o));e++)this.items.push(this.allocator())}}]),e}(),o=1024},804:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return l}));var n=r(53),a=r(86),u=r(793);r(43),r(77),r(744);function s(e){return e?{origin:Object(a.c)(e.origin),vector:Object(a.c)(e.vector)}:{origin:Object(a.e)(),vector:Object(a.e)()}}Object(a.e)(),Object(a.e)(),new u.a((function(){return{origin:null,vector:null}}));new u.a(s),new u.a((function(){return{p0:null,p1:null,p2:null}}));var i=Object(a.e)(),o=Object(a.e)(),c=function(){for(var e=new Uint32Array(131072),t=0;t<e.length;++t)e[t]=t;return e}(),f=new Uint16Array([0]),p=function(){for(var e=new Uint16Array(65536),t=0;t<e.length;++t)e[t]=t;return e}();function d(e){if(1===e)return f;if(e<p.length)return new Uint16Array(p.buffer,0,e);if(e>c.length){var t=Math.max(2*c.length,e);c=new Uint32Array(t);for(var r=0;r<c.length;r++)c[r]=r}return new Uint32Array(c.buffer,0,e)}function l(e){if(1===e)return new Uint16Array(f);if(e<p.length)return new Uint16Array(p.slice(0,e));if(e>c.length){for(var t=new Uint32Array(e),r=0;r<t.length;r++)t[r]=r;return t}return new Uint32Array(c.slice(0,e))}function h(e,t,r){if(!e)return!1;var a=e.size,u=e.data;Object(n.s)(r,0,0,0),Object(n.s)(x,0,0,0);for(var s,c,f,p=0,d=0,l=0;l<t.length-2;l+=3){var h=t[l+0]*a,b=t[l+1]*a,O=t[l+2]*a;Object(n.s)(m,u[h+0],u[h+1],u[h+2]),Object(n.s)(v,u[b+0],u[b+1],u[b+2]),Object(n.s)(y,u[O+0],u[O+1],u[O+2]);var w=(s=m,c=v,f=y,Object(n.g)(i,c,s),Object(n.g)(o,f,s),Object(n.m)(Object(n.d)(i,i,o))/2);w?(Object(n.c)(m,m,v),Object(n.c)(m,m,y),Object(n.b)(m,m,1/3*w),Object(n.c)(r,r,m),p+=w):(Object(n.c)(x,x,m),Object(n.c)(x,x,v),Object(n.c)(x,x,y),d+=3)}return(0!==d||0!==p)&&(0!==p?(Object(n.b)(r,r,1/p),!0):0!==d&&(Object(n.b)(r,x,1/d),!0))}function b(e,t,r){if(!e||!t)return!1;var a=e.size,u=e.data;Object(n.s)(r,0,0,0);for(var s=-1,i=0,o=0;o<t.length;o++){var c=t[o]*a;s!==c&&(r[0]+=u[c+0],r[1]+=u[c+1],r[2]+=u[c+2],i++),s=c}return i>1&&Object(n.b)(r,r,1/i),i>0}var m=Object(a.e)(),v=Object(a.e)(),y=Object(a.e)(),x=Object(a.e)()},845:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return a}));var n=r(665);function a(e,t,r){if(e.count===t.count)for(var a=e.count,u=r[0],s=r[1],i=r[2],o=r[3],c=r[4],f=r[5],p=r[6],d=r[7],l=r[8],h=e.typedBuffer,b=e.typedBufferStride,m=t.typedBuffer,v=t.typedBufferStride,y=0;y<a;y++){var x=y*b,O=y*v,w=m[O],k=m[O+1],g=m[O+2],j=m[O+3];h[x]=u*w+o*k+p*g,h[x+1]=s*w+c*k+d*g,h[x+2]=i*w+f*k+l*g,h[x+3]=j}else n.a.error("source and destination buffers need to have the same number of elements")}function u(e,t,r){for(var n=Math.min(e.count,t.count),a=e.typedBuffer,u=e.typedBufferStride,s=t.typedBuffer,i=t.typedBufferStride,o=0;o<n;o++){var c=o*u,f=o*i;a[c]=r*s[f],a[c+1]=r*s[f+1],a[c+2]=r*s[f+2],a[c+3]=r*s[f+3]}}function s(e,t,r){for(var n=Math.min(e.count,t.count),a=e.typedBuffer,u=e.typedBufferStride,s=t.typedBuffer,i=t.typedBufferStride,o=0;o<n;o++){var c=o*u,f=o*i;a[c]=s[f]>>r,a[c+1]=s[f+1]>>r,a[c+2]=s[f+2]>>r,a[c+3]=s[f+3]>>r}}Object.freeze({__proto__:null,transformMat4:function(e,t,r){if(e.count===t.count)for(var a=e.count,u=r[0],s=r[1],i=r[2],o=r[3],c=r[4],f=r[5],p=r[6],d=r[7],l=r[8],h=r[9],b=r[10],m=r[11],v=r[12],y=r[13],x=r[14],O=r[15],w=e.typedBuffer,k=e.typedBufferStride,g=t.typedBuffer,j=t.typedBufferStride,T=0;T<a;T++){var S=T*k,C=T*j,I=g[C],B=g[C+1],U=g[C+2],A=g[C+3];w[S]=u*I+c*B+l*U+v*A,w[S+1]=s*I+f*B+h*U+y*A,w[S+2]=i*I+p*B+b*U+x*A,w[S+3]=o*I+d*B+m*U+O*A}else n.a.error("source and destination buffers need to have the same number of elements")},transformMat3:a,scale:u,shiftRight:s})},846:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(6),a=r.n(n),u=r(14),s=r(2),i=r(3),o=r(59),c=r(143),f=r(20),p=r(8),d=r(24),l=r(27),h=function(){function e(t){Object(s.a)(this,e),this.streamDataRequester=t}return Object(i.a)(e,[{key:"loadJSON",value:function(){var e=Object(u.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("json",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadBinary",value:function(){var e=Object(u.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l.u)(t)?(Object(d.v)(r),Object(l.j)(t)):this.load("binary",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadImage",value:function(){var e=Object(u.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.load("image",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(u.a)(a.a.mark((function e(t,r,n){var u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(p.h)(this.streamDataRequester)){e.next=4;break}return e.next=3,Object(o.default)(r,{responseType:b[t]});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,Object(c.c)(this.streamDataRequester.request(r,t,n));case 6:if(!0!==(u=e.sent).ok){e.next=9;break}return e.abrupt("return",u.value);case 9:throw Object(d.u)(u.error),new f.a("","Request for resource failed: ".concat(u.error));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}(),b={image:"image",binary:"array-buffer",json:"json"}},847:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return u}));var n=r(144),a=r(804);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.c;return"number"==typeof e?t(e):Object(n.i)(e)||Object(n.k)(e)?new Uint32Array(e):e}function s(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e)for(var a=0,u=0;u<r;u+=1)u%2==0?(n[a++]=u,n[a++]=u+1,n[a++]=u+2):(n[a++]=u+1,n[a++]=u,n[a++]=u+2);else for(var s=0,i=0;i<r;i+=1)if(i%2==0){var o=e[i],c=e[i+1],f=e[i+2];n[s++]=o,n[s++]=c,n[s++]=f}else{var p=e[i+1],d=e[i],l=e[i+2];n[s++]=p,n[s++]=d,n[s++]=l}return n}function i(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){for(var a=0,u=0;u<r;++u)n[a++]=0,n[a++]=u+1,n[a++]=u+2;return n}for(var s=e[0],i=e[1],o=0,c=0;c<r;++c){var f=e[c+2];n[o++]=s,n[o++]=i,n[o++]=f,i=f}return n}},848:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=2.1},860:function(e,t,r){"use strict";r.d(t,"a",(function(){return Q}));var n=r(32),a=r(15),u=r(6),s=r.n(u),i=r(14),o=r(8),c=r(603),f=r(2),p=r(3),d=r(20),l=r(9).a.getLogger("esri.views.3d.glTF"),h=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"error",value:function(e){throw new d.a("gltf-loader-error",e)}},{key:"errorUnsupported",value:function(e){throw new d.a("gltf-loader-unsupported-feature",e)}},{key:"errorUnsupportedIf",value:function(e,t){e&&this.errorUnsupported(t)}},{key:"assert",value:function(e,t){e||this.error(t)}},{key:"warn",value:function(e){l.warn(e)}},{key:"warnUnsupported",value:function(e){this.warn("[Unsupported Feature] "+e)}},{key:"warnUnsupportedIf",value:function(e,t){e&&this.warnUnsupported(t)}}]),e}(),b=r(11);var m=r(237),v=r(27),y=r(389),x=r(230),O=r(634),w=r(616),k=r(619),g=r(792),j=function(){function e(t){Object(f.a)(this,e),this.data=t,this.offset4=0,this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}return Object(p.a)(e,[{key:"readUint32",value:function(){var e=this.offset4;return this.offset4+=1,this.dataUint32[e]}},{key:"readUint8Array",value:function(e){var t=4*this.offset4;return this.offset4+=e/4,new Uint8Array(this.data,t,e)}},{key:"remainingBytes",value:function(){return this.data.byteLength-4*this.offset4}}]),e}(),T={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},S={pbrMetallicRoughness:T,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},C={ESRI_externalColorMixMode:"tint"},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(b.a)(Object(b.a)({},T),e.pbrMetallicRoughness),r=B(Object(b.a)(Object(b.a)({},C),e.extras));return Object(b.a)(Object(b.a)(Object(b.a)({},S),e),{},{pbrMetallicRoughness:t,extras:r})};function B(e){switch(e.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:Object(m.a)(e.ESRI_externalColorMixMode),e.ESRI_externalColorMixMode="tint"}return e}var U={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497},A=function(e){return Object(b.a)(Object(b.a)({},U),e)};var M=1179937895,R=1313821514,N=5130562,_=function(){function e(t,r,n,a,u){Object(f.a)(this,e),this.context=t,this.errorContext=r,this.uri=n,this.json=a,this.glbBuffer=u,this.bufferCache=new Map,this.textureCache=new Map,this.materialCache=new Map,this.nodeParentMap=new Map,this.nodeTransformCache=new Map,this.baseUri=function(e){var t,r;return e.replace(/^(.*\/)?([^/]*)$/,(function(e,n,a){return t=n||"",r=a||"",""})),{dirPart:t,filePart:r}}(this.uri).dirPart,this.checkVersionSupported(),this.checkRequiredExtensionsSupported(),r.errorUnsupportedIf(null==a.scenes,"Scenes must be defined."),r.errorUnsupportedIf(null==a.meshes,"Meshes must be defined"),r.errorUnsupportedIf(null==a.nodes,"Nodes must be defined."),this.computeNodeParents()}return Object(p.a)(e,[{key:"getBuffer",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a,u,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.json.buffers[t],a=this.errorContext,null!=n.uri){e.next=3;break}return e.abrupt("return",(a.assert(null!=this.glbBuffer,"GLB buffer not present"),this.glbBuffer));case 3:if(u=this.bufferCache.get(t)){e.next=9;break}return e.next=7,this.context.loadBinary(this.resolveUri(n.uri),r);case 7:i=e.sent,u=new Uint8Array(i),this.bufferCache.set(t,u),a.assert(u.byteLength===n.byteLength,"Buffer byte lengths should match.");case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAccessor",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a,u,i,o,c,f,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.json.accessors[t],(a=this.errorContext).errorUnsupportedIf(null==n.bufferView,"Some accessor does not specify a bufferView."),a.errorUnsupportedIf(n.type in["MAT2","MAT3","MAT4"],"AttributeType ".concat(n.type," is not supported")),u=this.json.bufferViews[n.bufferView],e.next=5,this.getBuffer(u.buffer,r);case 5:return i=e.sent,o=F[n.type],c=D[n.componentType],f=o*c,p=u.byteStride||f,e.abrupt("return",{raw:i.buffer,byteStride:p,byteOffset:i.byteOffset+(u.byteOffset||0)+(n.byteOffset||0),entryCount:n.count,isDenselyPacked:p===f,componentCount:o,componentByteSize:c,componentType:n.componentType,min:n.min,max:n.max,normalized:!!n.normalized});case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getIndexData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.indices){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.getAccessor(t.indices,r);case 4:if(!(n=e.sent).isDenselyPacked){e.next=14;break}e.t0=n.componentType,e.next=5121===e.t0?9:5123===e.t0?10:5125===e.t0?11:12;break;case 9:return e.abrupt("return",new Uint8Array(n.raw,n.byteOffset,n.entryCount));case 10:return e.abrupt("return",new Uint16Array(n.raw,n.byteOffset,n.entryCount));case 11:return e.abrupt("return",new Uint32Array(n.raw,n.byteOffset,n.entryCount));case 12:e.next=20;break;case 14:e.t1=n.componentType,e.next=5121===e.t1?17:5123===e.t1?18:5125===e.t1?19:20;break;case 17:return e.abrupt("return",Object(g.a)(this.wrapAccessor(k.l,n)));case 18:return e.abrupt("return",Object(g.a)(this.wrapAccessor(k.j,n)));case 19:return e.abrupt("return",Object(g.a)(this.wrapAccessor(k.k,n)));case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getPositionData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).errorUnsupportedIf(null==t.attributes.POSITION,"No POSITION vertex data found."),e.next=4,this.getAccessor(t.attributes.POSITION,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for POSITION vertex attribute, but found "+q[a.componentType]),n.errorUnsupportedIf(3!==a.componentCount,"POSITION vertex attribute must have 3 components, but found "+a.componentCount.toFixed()),this.wrapAccessor(k.u,a)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNormalData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.NORMAL,"No NORMAL vertex data found."),e.next=4,this.getAccessor(t.attributes.NORMAL,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for NORMAL vertex attribute, but found "+q[a.componentType]),n.errorUnsupportedIf(3!==a.componentCount,"NORMAL vertex attribute must have 3 components, but found "+a.componentCount.toFixed()),this.wrapAccessor(k.u,a)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTangentData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.TANGENT,"No TANGENT vertex data found."),e.next=4,this.getAccessor(t.attributes.TANGENT,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(5126!==a.componentType,"Expected type FLOAT for TANGENT vertex attribute, but found "+q[a.componentType]),n.errorUnsupportedIf(4!==a.componentCount,"TANGENT vertex attribute must have 4 components, but found "+a.componentCount.toFixed()),new k.C(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount)));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTextureCoordinates",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.TEXCOORD_0,"No TEXCOORD_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.TEXCOORD_0,r);case 4:return a=e.sent,e.abrupt("return",(n.errorUnsupportedIf(2!==a.componentCount,"TEXCOORD_0 vertex attribute must have 2 components, but found "+a.componentCount.toFixed()),5126===a.componentType?this.wrapAccessor(k.m,a):(n.errorUnsupportedIf(!a.normalized,"Integer component types are only supported for a normalized accessor for TEXCOORD_0."),G(a))));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getVertexColors",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.errorContext).assert(null!=t.attributes.COLOR_0,"No COLOR_0 vertex data found."),e.next=4,this.getAccessor(t.attributes.COLOR_0,r);case 4:if(a=e.sent,n.errorUnsupportedIf(4!==a.componentCount&&3!==a.componentCount,"COLOR_0 attribute must have 3 or 4 components, but found "+a.componentCount.toFixed()),4!==a.componentCount){e.next=14;break}if(5126!==a.componentType){e.next=8;break}return e.abrupt("return",this.wrapAccessor(k.C,a));case 8:if(5121!==a.componentType){e.next=10;break}return e.abrupt("return",this.wrapAccessor(k.J,a));case 10:if(5123!==a.componentType){e.next=12;break}return e.abrupt("return",this.wrapAccessor(k.H,a));case 12:e.next=21;break;case 14:if(3!==a.componentCount){e.next=21;break}if(5126!==a.componentType){e.next=17;break}return e.abrupt("return",this.wrapAccessor(k.u,a));case 17:if(5121!==a.componentType){e.next=19;break}return e.abrupt("return",this.wrapAccessor(k.B,a));case 19:if(5123!==a.componentType){e.next=21;break}return e.abrupt("return",this.wrapAccessor(k.z,a));case 21:n.errorUnsupported("Unsupported component type for COLOR_0 attribute: "+q[a.componentType]);case 22:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hasPositions",value:function(e){return void 0!==e.attributes.POSITION}},{key:"hasNormals",value:function(e){return void 0!==e.attributes.NORMAL}},{key:"hasVertexColors",value:function(e){return void 0!==e.attributes.COLOR_0}},{key:"hasTextureCoordinates",value:function(e){return void 0!==e.attributes.TEXCOORD_0}},{key:"hasTangents",value:function(e){return void 0!==e.attributes.TANGENT}},{key:"getMaterial",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r,n){var a,u,i,o,c,f,p,d,l,h,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.errorContext,u=this.materialCache.get(t.material)){e.next=48;break}if(i=null!=t.material?I(this.json.materials[t.material]):I(),o=i.pbrMetallicRoughness,c=this.hasVertexColors(t),e.t0=o.baseColorTexture,!e.t0){e.next=10;break}return a.errorUnsupportedIf(0!==(o.baseColorTexture.texCoord||0),"Only TEXCOORD with index 0 is supported."),e.next=9,this.getTexture(o.baseColorTexture.index,r);case 9:f=e.sent;case 10:if(e.t1=i.normalTexture,!e.t1){e.next=19;break}if(0===(i.normalTexture.texCoord||0)){e.next=16;break}a.warnUnsupported("Only TEXCOORD with index 0 is supported for the normal map texture."),e.next=19;break;case 16:return e.next=18,this.getTexture(i.normalTexture.index,r);case 18:p=e.sent;case 19:if(e.t2=i.occlusionTexture&&n,!e.t2){e.next=28;break}if(0===(i.occlusionTexture.texCoord||0)){e.next=25;break}a.warnUnsupported("Only TEXCOORD with index 0 is supported for the occlusion texture."),e.next=28;break;case 25:return e.next=27,this.getTexture(i.occlusionTexture.index,r);case 27:d=e.sent;case 28:if(e.t3=i.emissiveTexture&&n,!e.t3){e.next=37;break}if(0===(i.emissiveTexture.texCoord||0)){e.next=34;break}a.warnUnsupported("Only TEXCOORD with index 0 is supported for the emissive texture."),e.next=37;break;case 34:return e.next=36,this.getTexture(i.emissiveTexture.index,r);case 36:l=e.sent;case 37:if(e.t4=o.metallicRoughnessTexture&&n,!e.t4){e.next=46;break}if(0===(o.metallicRoughnessTexture.texCoord||0)){e.next=43;break}a.warnUnsupported("Only TEXCOORD with index 0 is supported for the metallicRoughness texture."),e.next=46;break;case 43:return e.next=45,this.getTexture(o.metallicRoughnessTexture.index,r);case 45:h=e.sent;case 46:b=null!=t.material?t.material:-1,u={alphaMode:i.alphaMode,alphaCutoff:i.alphaCutoff,color:o.baseColorFactor,doubleSided:!!i.doubleSided,colorTexture:f,normalTexture:p,name:i.name,id:b,occlusionTexture:d,emissiveTexture:l,emissiveFactor:i.emissiveFactor,metallicFactor:o.metallicFactor,roughnessFactor:o.roughnessFactor,metallicRoughnessTexture:h,vertexColors:c,ESRI_externalColorMixMode:i.extras.ESRI_externalColorMixMode};case 48:return e.abrupt("return",u);case 49:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getTexture",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a,u,i,o,c,f,p,d,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.errorContext,a=this.json.textures[t],u=A(null!=a.sampler?this.json.samplers[a.sampler]:{}),n.errorUnsupportedIf(null==a.source,"Source is expected to be defined for a texture."),i=this.json.images[a.source],o=this.textureCache.get(t)){e.next=22;break}if(!i.uri){e.next=11;break}return e.next=8,this.context.loadImage(this.resolveUri(i.uri),r);case 8:c=e.sent,e.next=20;break;case 11:return n.errorUnsupportedIf(null==i.bufferView,"Image bufferView must be defined."),n.errorUnsupportedIf(null==i.mimeType,"Image mimeType must be defined."),f=this.json.bufferViews[i.bufferView],e.next=15,this.getBuffer(f.buffer,r);case 15:return p=e.sent,n.errorUnsupportedIf(null!=f.byteStride,"byteStride not supported for image buffer"),e.next=19,H(new Uint8Array(p.buffer,p.byteOffset+(f.byteOffset||0),f.byteLength),i.mimeType);case 19:c=e.sent;case 20:l=function(e){return n.error("Unexpected TextureSampler WrapMode: ".concat(e,". Using default REPEAT(10497).")),10497},o={data:c,wrapS:(d=function(e){return 33071===e||33648===e||10497===e})(u.wrapS)?u.wrapS:l(u.wrapS),wrapT:d(u.wrapT)?u.wrapT:l(u.wrapT),minFilter:u.minFilter,name:i.name,id:t},this.textureCache.set(t,o);case 22:return e.abrupt("return",o);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNodeTransform",value:function(e){if(void 0===e)return L;var t=this.nodeTransformCache.get(e);if(!t){var r=this.getNodeTransform(this.getNodeParent(e)),n=this.json.nodes[e];n.matrix?t=Object(x.i)(Object(c.d)(),r,n.matrix):n.translation||n.rotation||n.scale?(t=Object(c.c)(r),n.translation&&Object(x.m)(t,t,n.translation),n.rotation&&(P[3]=Object(O.b)(P,n.rotation),Object(x.b)(t,t,P[3],P)),n.scale&&Object(x.l)(t,t,n.scale)):t=r,this.nodeTransformCache.set(e,t)}return t}},{key:"wrapAccessor",value:function(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}},{key:"resolveUri",value:function(e){return Object(v.A)(e,this.baseUri)}},{key:"getNodeParent",value:function(e){return this.nodeParentMap.get(e)}},{key:"checkVersionSupported",value:function(){var e=y.a.parse(this.json.asset.version,"glTF");E.validate(e)}},{key:"checkRequiredExtensionsSupported",value:function(){var e=this.json,t=this.errorContext;e.extensionsRequired&&0!==e.extensionsRequired.length&&t.errorUnsupported("gltf loader was not able to load unsupported feature. Required extensions: "+e.extensionsRequired.join(", "))}},{key:"computeNodeParents",value:function(){var e=this;this.json.nodes.forEach((function(t,r){t.children&&t.children.forEach((function(t){e.nodeParentMap.set(t,r)}))}))}}],[{key:"load",value:function(){var t=Object(i.a)(s.a.mark((function t(r,n,a,u){var i,o,c,f,p,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(v.u)(a)){t.next=13;break}if("model/gltf-binary"===(i=Object(v.i)(a)).mediaType){t.next=10;break}return t.prev=3,o=JSON.parse(i.isBase64?atob(i.data):i.data),t.abrupt("return",new e(r,n,a,o));case 8:t.prev=8,t.t0=t.catch(3);case 10:if(c=Object(v.j)(a),!e.isGLBData(c)){t.next=13;break}return t.abrupt("return",this.fromGLBData(r,n,a,c));case 13:if(!a.endsWith(".gltf")){t.next=18;break}return t.next=16,r.loadJSON(a,u);case 16:return f=t.sent,t.abrupt("return",new e(r,n,a,f));case 18:return t.next=20,r.loadBinary(a,u);case 20:if(p=t.sent,!e.isGLBData(p)){t.next=23;break}return t.abrupt("return",this.fromGLBData(r,n,a,p));case 23:return t.next=25,r.loadJSON(a,u);case 25:return d=t.sent,t.abrupt("return",new e(r,n,a,d));case 27:case"end":return t.stop()}}),t,this,[[3,8]])})));return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"isGLBData",value:function(e){var t=new j(e);return t.remainingBytes()>=4&&t.readUint32()===M}},{key:"fromGLBData",value:function(){var t=Object(i.a)(s.a.mark((function t(r,n,a,u){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.parseGLBData(n,u);case 2:return i=t.sent,t.abrupt("return",new e(r,n,a,i.json,i.binaryData));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"parseGLBData",value:function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n,a,u,i,o,c,f,p,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new j(r),t.assert(n.remainingBytes()>=12,"GLB binary data is insufficiently large."),a=n.readUint32(),u=n.readUint32(),i=n.readUint32(),t.assert(a===M,"Magic first 4 bytes do not fit to expected GLB value."),t.assert(r.byteLength>=i,"GLB binary data is smaller than header specifies."),t.errorUnsupportedIf(2!==u,"An unsupported GLB container version was detected. Only version 2 is supported."),f=0;case 5:if(!(n.remainingBytes()>=8)){e.next=19;break}if(p=n.readUint32(),d=n.readUint32(),0!==f){e.next=15;break}return t.assert(d===R,"First GLB chunk must be JSON."),t.assert(p>=0,"No JSON data found."),e.next=12,V(n.readUint8Array(p));case 12:o=e.sent,e.next=16;break;case 15:1===f?(t.errorUnsupportedIf(d!==N,"Second GLB chunk expected to be BIN."),c=n.readUint8Array(p)):t.warnUnsupported("More than 2 GLB chunks detected. Skipping.");case 16:f+=1;case 17:e.next=5;break;case 19:return e.abrupt("return",(o||t.error("No GLB JSON chunk detected."),{json:o,binaryData:c}));case 20:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),E=new y.a(2,0,"glTF"),L=Object(x.j)(Object(c.d)(),Math.PI/2),P=Object(w.b)(),F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},D={5120:1,5121:1,5122:2,5123:2,5126:4,5125:4};function G(e){switch(e.componentType){case 5120:return new k.q(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5121:return new k.t(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5122:return new k.o(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5123:return new k.r(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5125:return new k.s(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case 5126:return new k.m(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);default:return void Object(m.a)(e.componentType)}}function V(e){return z.apply(this,arguments)}function z(){return(z=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new Blob([t]),a=new FileReader;a.onload=function(){var t=a.result;e(JSON.parse(t))},a.onerror=function(e){r(e)},a.readAsText(n)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){return X.apply(this,arguments)}function X(){return(X=Object(i.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var a=new Blob([t],{type:r}),u=URL.createObjectURL(a),s=new Image;s.addEventListener("load",(function(){URL.revokeObjectURL(u),"decode"in s?s.decode().then((function(){return e(s)}),(function(){return e(s)})):e(s)})),s.addEventListener("error",(function(e){URL.revokeObjectURL(u),n(e)})),s.src=u})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5125:"UNSIGNED_INT",5126:"FLOAT"},J=0;function Q(e,t){return W.apply(this,arguments)}function W(){return(W=Object(i.a)(s.a.mark((function e(t,r){var n,a,u,f,p,d,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>2&&void 0!==l[2]?l[2]:{},a=!(l.length>3&&void 0!==l[3])||l[3],e.next=4,_.load(t,te,r,n);case 4:return u=e.sent,f="gltf_"+J++,p={lods:[],materials:new Map,textures:new Map,meta:Y(u)},d=!(!u.json.asset.extras||"symbolResource"!==u.json.asset.extras.ESRI_type),e.next=10,Z(u,function(){var e=Object(i.a)(s.a.mark((function e(t,r,i,d){var l,h,b,m,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=void 0!==t.mode?t.mode:4,h=4===l||5===l||6===l?l:null,!Object(o.h)(h)){e.next=3;break}return e.abrupt("return",void te.warnUnsupported("Unsupported primitive mode ("+ne[l]+"). Skipping primitive."));case 3:if(u.hasPositions(t)){e.next=5;break}return e.abrupt("return",void te.warn("Skipping primitive without POSITION vertex attribute."));case 5:return e.next=7,u.getMaterial(t,n,a);case 7:return b=e.sent,e.t0=Object(c.c)(r),e.next=11,u.getPositionData(t,n);case 11:return e.t1=e.sent,e.t2={position:e.t1,normal:null,texCoord0:null,color:null,tangent:null},e.next=15,u.getIndexData(t,n);case 15:if(e.t3=e.sent,e.t4=h,e.t5=ee(p,b,f),m={transform:e.t0,attributes:e.t2,indices:e.t3,primitiveType:e.t4,material:e.t5},e.t6=u.hasNormals(t),!e.t6){e.next=24;break}return e.next=23,u.getNormalData(t,n);case 23:m.attributes.normal=e.sent;case 24:if(e.t7=u.hasTangents(t),!e.t7){e.next=29;break}return e.next=28,u.getTangentData(t,n);case 28:m.attributes.tangent=e.sent;case 29:if(e.t8=u.hasTextureCoordinates(t),!e.t8){e.next=34;break}return e.next=33,u.getTextureCoordinates(t,n);case 33:m.attributes.texCoord0=e.sent;case 34:if(e.t9=u.hasVertexColors(t),!e.t9){e.next=39;break}return e.next=38,u.getVertexColors(t,n);case 38:m.attributes.color=e.sent;case 39:v=null,Object(o.i)(p.meta)&&Object(o.i)(p.meta.ESRI_lod)&&"screenSpaceRadius"===p.meta.ESRI_lod.metric&&(v=p.meta.ESRI_lod.thresholds[i]),p.lods[i]=p.lods[i]||{parts:[],name:d,lodThreshold:v},p.lods[i].parts.push(m);case 41:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}());case 10:return e.abrupt("return",{model:p,meta:{isEsriSymbolResource:d,uri:u.uri},customMeta:{}});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){var t=e.json,r=null;return t.nodes.forEach((function(e){var t=e.extras;Object(o.i)(t)&&(t.ESRI_proxyEllipsoid||t.ESRI_lod)&&(r=t)})),r}function Z(e,t){return $.apply(this,arguments)}function $(){return($=Object(i.a)(s.a.mark((function e(t,r){var u,o,c,f,p,d,l,h,b,m,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=function(){return(v=Object(i.a)(s.a.mark((function e(n,i){var o,c,f,p,d,l,h,b,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.nodes[n],c=t.getNodeTransform(n),te.warnUnsupportedIf(null!=o.weights,"Morph targets are not supported."),null==o.mesh){e.next=20;break}f=u.meshes[o.mesh],p=Object(a.a)(f.primitives),e.prev=4,p.s();case 6:if((d=p.n()).done){e.next=12;break}return l=d.value,e.next=10,r(l,c,i,f.name);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),p.e(e.t0);case 17:return e.prev=17,p.f(),e.finish(17);case 20:h=Object(a.a)(o.children||[]),e.prev=21,h.s();case 23:if((b=h.n()).done){e.next=29;break}return v=b.value,e.next=27,m(v,i);case 27:e.next=23;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(21),h.e(e.t1);case 34:return e.prev=34,h.f(),e.finish(34);case 37:case"end":return e.stop()}}),e,null,[[4,14,17,20],[21,31,34,37]])})))).apply(this,arguments)},m=function(e,t){return v.apply(this,arguments)},u=t.json,o=u.scenes[u.scene||0].nodes,c=o.length>1,f=Object(a.a)(o),e.prev=4,f.s();case 6:if((p=f.n()).done){e.next=14;break}return d=p.value,l=u.nodes[d],h=[m(d,0)],K(l)&&!c&&(b=l.extensions.MSFT_lod.ids,h.push.apply(h,Object(n.a)(b.map((function(e,t){return m(e,t+1)}))))),e.next=12,Promise.all(h);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),f.e(e.t0);case 19:return e.prev=19,f.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})))).apply(this,arguments)}function K(e){return e.extensions&&e.extensions.MSFT_lod&&Array.isArray(e.extensions.MSFT_lod.ids)}function ee(e,t,r){var n=function(t){var n="".concat(r,"_tex_").concat(t&&t.id).concat(t&&t.name?"_"+t.name:"");if(t&&!e.textures.has(n)){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{data:e,parameters:Object(b.a)({wrap:Object(b.a)({s:10497,t:10497},t.wrap),noUnpackFlip:!0,mipmap:!1},t)}}(t.data,{wrap:{s:t.wrapS,t:t.wrapT},mipmap:re.some((function(e){return e===t.minFilter})),noUnpackFlip:!0});e.textures.set(n,a)}return n},a="".concat(r,"_mat_").concat(t.id,"_").concat(t.name);if(!e.materials.has(a)){var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(b.a)({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},e)}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?n(t.colorTexture):void 0,textureNormal:t.normalTexture?n(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?n(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?n(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?n(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(a,u)}return a}var te=new h,re=[9987,9985],ne=["POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN"]},867:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(688);Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,i=r?r.count:t.count,o=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*s,f=0;f<i;++f){for(var p=0;p<9;++p)n[o+p]=u[c+p];o+=a,c+=s}}});Object.freeze({__proto__:null,copy:function(e,t,r){for(var n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,s=t.typedBufferStride,i=r?r.count:t.count,o=(r&&r.dstIndex?r.dstIndex:0)*a,c=(r&&r.srcIndex?r.srcIndex:0)*s,f=0;f<i;++f){for(var p=0;p<16;++p)n[o+p]=u[c+p];o+=a,c+=s}}}),r(792),r(731),r(648),r(732);function a(e,t){return new e(new ArrayBuffer(t*e.ElementCount*Object(n.a)(e.ElementType)))}}}]);
//# sourceMappingURL=16.a59a82c6.chunk.js.map