(this.webpackJsonpdivine=this.webpackJsonpdivine||[]).push([[1],{529:function(t,e,i){"use strict";i.d(e,"b",(function(){return T})),i.d(e,"c",(function(){return x}));var n=i(2),r=i(3),a=i(10),s=i(8),o=i(527),l=function(){function t(){for(Object(n.a)(this,t),this._current=new Array,this._max=new Array,this._allocations=new Map;this._current.length<o.b.COUNT;)this._current.push(0),this._max.push(0)}return Object(r.a)(t,[{key:"resetMax",value:function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)}},{key:"increment",value:function(t,e){var i=++this._current[t];this._max[t]=Math.max(i,this._max[t])}},{key:"decrement",value:function(t,e){--this._current[t]}},{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((function(t,e){return t+e}),0)}},{key:"printResourceCount",value:function(){if(this.total>0){console.log("Live objects:");for(var t=0;t<o.b.COUNT;++t){var e=this._current[t];e>0&&console.log("".concat(o.b[t],": ").concat(e))}}if(this._allocations.size>0){console.log("".concat(this._allocations.size," live object allocations:"));var i=new Map;this._allocations.forEach((function(t){var e;i.set(t,(null!=(e=i.get(t))?e:0)+1)})),i.forEach((function(t,e){return console.log(t," : ",e)}))}}}]),t}(),c=i(753),u=i(526),h=i(612),f=i(15),_=i(813);function d(t,e){var i,n,r,a,s,o,l,c,u,f,d,v=e.disabledExtensions||{},p=e.debugWebGLExtensions||{},m=null,b=null,T=null,x=null;return{get drawBuffers(){return d||(d=function(t,e){if(e.disjointTimerQuery)return null;if(Object(h.a)(t))return{drawBuffers:t.drawBuffers.bind(t),MAX_DRAW_BUFFERS:t.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:t.MAX_COLOR_ATTACHMENTS};if(e.drawBuffers)return null;var i=t.getExtension("WEBGL_draw_buffers");return i?{drawBuffers:i.drawBuffersWEBGL.bind(i),MAX_DRAW_BUFFERS:i.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:i.MAX_COLOR_ATTACHMENTS_WEBGL}:null}(t,v)),d},get instancing(){return i||(i=function(t){if(Object(h.a)(t))return{drawArraysInstanced:t.drawArraysInstanced.bind(t),drawElementsInstanced:t.drawElementsInstanced.bind(t),vertexAttribDivisor:t.vertexAttribDivisor.bind(t)};var e=t.getExtension("ANGLE_instanced_arrays");return e?{drawArraysInstanced:e.drawArraysInstancedANGLE.bind(e),drawElementsInstanced:e.drawElementsInstancedANGLE.bind(e),vertexAttribDivisor:e.vertexAttribDivisorANGLE.bind(e)}:null}(t)),i},get vao(){return n||(n=function(t,e){if(Object(h.a)(t))return{createVertexArray:t.createVertexArray.bind(t),deleteVertexArray:t.deleteVertexArray.bind(t),bindVertexArray:t.bindVertexArray.bind(t)};if(e.vao)return null;var i=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object");return i?{createVertexArray:i.createVertexArrayOES.bind(i),deleteVertexArray:i.deleteVertexArrayOES.bind(i),bindVertexArray:i.bindVertexArrayOES.bind(i)}:null}(t,v)),n},get compressedTextureETC(){return r||(r=function(t,e){if(e.compressedTextureETC)return null;var i=t.getExtension("WEBGL_compressed_texture_etc");return i?{COMPRESSED_R11_EAC:i.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:i.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:i.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:i.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:i.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:i.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}(t,v)),r},get compressedTextureS3TC(){return a||(a=function(t,e){if(e.compressedTextureS3TC)return null;var i=t.getExtension("WEBGL_compressed_texture_s3tc");return i?{COMPRESSED_RGB_S3TC_DXT1:i.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:i.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:i.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:i.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}(t,v)),a},get textureFilterAnisotropic(){return s||(s=function(t,e){if(e.textureFilterAnisotropic)return null;var i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return i?{MAX_TEXTURE_MAX_ANISOTROPY:i.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:i.TEXTURE_MAX_ANISOTROPY_EXT}:null}(t,v)),s},get disjointTimerQuery(){return o||(o=Object(_.a)(t,v)),o},get textureFloat(){return l||(l=function(t,e){if(Object(h.a)(t))return{textureFloat:!0,textureFloatLinear:!e.textureFloatLinear&&!!t.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!e.textureHalfFloatLinear&&!!t.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:t.HALF_FLOAT};if(t instanceof WebGLRenderingContext){var i=!e.textureHalfFloat&&t.getExtension("OES_texture_half_float");return{textureFloat:!e.textureFloat&&!!t.getExtension("OES_texture_float"),textureFloatLinear:!e.textureFloatLinear&&!!t.getExtension("OES_texture_float_linear"),textureHalfFloat:!!i,textureHalfFloatLinear:!e.textureHalfFloatLinear&&!!t.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:i?i.HALF_FLOAT_OES:void 0}}return null}(t,v)),l},get colorBufferFloat(){return c||(c=function(t,e){if(Object(h.a)(t)){var i=!e.colorBufferFloat&&t.getExtension("EXT_color_buffer_half_float"),n=!e.colorBufferFloat&&t.getExtension("EXT_color_buffer_float"),r=!e.colorBufferFloat&&t.getExtension("EXT_float_blend");return i||n||r?{textureFloat:!!n,textureHalfFloat:!!i,R16F:t.R16F,RG16F:t.RG16F,RGBA16F:t.RGBA16F,R32F:t.R32F,RG32F:t.RG32F,RGBA32F:t.RGBA32F,R11F_G11F_B10F:t.R11F_G11F_B10F,RGB16F:t.RGB16F}:null}if(t instanceof WebGLRenderingContext){var a=!e.colorBufferFloat&&t.getExtension("EXT_color_buffer_half_float"),s=!e.colorBufferFloat&&t.getExtension("WEBGL_color_buffer_float"),o=!e.colorBufferFloat&&t.getExtension("EXT_float_blend");return a||s||o?{textureFloat:!!s,textureHalfFloat:!!a,RGBA16F:a?a.RGBA16F_EXT:void 0,RGB16F:a?a.RGB16F_EXT:void 0,RGBA32F:s?s.RGBA32F_EXT:void 0}:null}return null}(t,v)),c},get blendMinMax(){return u||(u=function(t,e){if(Object(h.a)(t))return{MIN:t.MIN,MAX:t.MAX};if(e.blendMinMax)return null;var i=t.getExtension("EXT_blend_minmax");return i?{MIN:i.MIN_EXT,MAX:i.MAX_EXT}:null}(t,v)),u},get depthTexture(){return null===m&&(m=g(t,v,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"])),m},get standardDerivatives(){return null===b&&(b=g(t,v,"standardDerivatives",!0,["OES_standard_derivatives"])),b},get shaderTextureLOD(){return null===T&&(T=g(t,v,"shaderTextureLOD",!0,["EXT_shader_texture_lod"])),T},get fragDepth(){return null===x&&(x=g(t,v,"fragDepth",!0,["EXT_frag_depth"])),x},get loseContext(){return f||(f=function(t,e){var i=e.loseContext&&t.getExtension("WEBGL_lose_context");return i?{loseRenderingContext:function(){return i.loseContext()}}:null}(t,p)),f},enable:function(t){return this[t]}}}function g(t,e,i,n,r){if(n&&Object(h.a)(t))return!0;if(e[i])return!1;var a,s=Object(f.a)(r);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(t.getExtension(o))return!0}}catch(l){s.e(l)}finally{s.f()}return!1}var v=function(){function t(e){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(n.a)(this,t),this.gl=e,this.instanceCounter=new l,this._blendEnabled=!1,this._blendColorState={r:0,g:0,b:0,a:0},this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0},this._blendEquationState={mode:32774,modeAlpha:32774},this._colorMaskState={r:!0,g:!0,b:!0,a:!0},this._polygonCullingEnabled=!1,this._cullFace=1029,this._frontFace=2305,this._scissorTestEnabled=!1,this._scissorRect={x:0,y:0,width:0,height:0},this._depthTestEnabled=!1,this._depthFunction=513,this._clearDepth=1,this._depthWriteEnabled=!0,this._depthRange={zNear:0,zFar:1},this._viewport=null,this._stencilTestEnabled=!1,this._polygonOffsetFillEnabled=!1,this._polygonOffset=[0,0],this._stencilFunction={face:1032,func:519,ref:0,mask:1},this._clearStencil=0,this._stencilWriteMask=1,this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680},this._clearColor={r:0,g:0,b:0,a:0},this._activeShaderProgram=null,this._activeVertexBuffer=null,this._activeIndexBuffer=null,this._activeFramebuffer=null,this._activeRenderbuffer=null,this._activeTextureUnit=0,this._textureUnitMap=new Array,this._numOfDrawCalls=0,this._numOfTriangles=0,this.webglVersion=Object(h.a)(e)?"webgl2":"webgl",e instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint"),this._capabilities=d(e,r),this._parameters=this._loadParameters(r);var a=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]},this._stateTracker=new c.a({setBlending:function(t){if(t){i.setBlendingEnabled(!0),i.setBlendEquationSeparate(t.opRgb,t.opAlpha),i.setBlendFunctionSeparate(t.srcRgb,t.dstRgb,t.srcAlpha,t.dstAlpha);var e=t.color;i.setBlendColor(e.r,e.g,e.b,e.a)}else i.setBlendingEnabled(!1)},setCulling:function(t){t?(i.setFaceCullingEnabled(!0),i.setCullFace(t.face),i.setFrontFace(t.mode)):i.setFaceCullingEnabled(!1)},setPolygonOffset:function(t){t?(i.setPolygonOffsetFillEnabled(!0),i.setPolygonOffset(t.factor,t.units)):i.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(t){t?(i.setDepthTestEnabled(!0),i.setDepthFunction(t.func)):i.setDepthTestEnabled(!1)},setStencilTest:function(t){if(t){i.setStencilTestEnabled(!0);var e=t.function;i.setStencilFunction(e.func,e.ref,e.mask);var n=t.operation;i.setStencilOp(n.fail,n.zFail,n.zPass)}else i.setStencilTestEnabled(!1)},setDepthWrite:function(t){t?(i.setDepthWriteEnabled(!0),i.setDepthRange(t.zNear,t.zFar)):i.setDepthWriteEnabled(!1)},setColorWrite:function(t){t?i.setColorMask(t.r,t.g,t.b,t.a):i.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(t){t?i.setStencilWriteMask(t.mask):i.setStencilWriteMask(0)}}),this.enforceState()}return Object(r.a)(t,[{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"dispose",value:function(){this.bindVAO(null),this.unbindBuffer(34962),this.unbindBuffer(34963),this._textureUnitMap.length=0,T()&&this.instanceCounter.printResourceCount()}},{key:"setPipelineState",value:function(t){this._stateTracker.setPipeline(t)}},{key:"setBlendingEnabled",value:function(t){this._blendEnabled!==t&&(!0===t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=t,this._stateTracker.invalidateBlending())}},{key:"externalTextureUnitUpdate",value:function(t,e){for(var i=0;i<t.length;++i)this._textureUnitMap[t[i]]=null;e>=0&&(this._activeTextureUnit=e)}},{key:"externalVertexArrayObjectUpdate",value:function(){var t=this.capabilities.vao;t&&(t.bindVertexArray(null),this._activeVertexArrayObject=null),this._activeVertexBuffer=null,this._activeIndexBuffer=null}},{key:"externalVertexBufferUpdate",value:function(){this._activeVertexBuffer=null}},{key:"externalIndexBufferUpdate",value:function(){this._activeIndexBuffer=null}},{key:"setBlendColor",value:function(t,e,i,n){t===this._blendColorState.r&&e===this._blendColorState.g&&i===this._blendColorState.b&&n===this._blendColorState.a||(this.gl.blendColor(t,e,i,n),this._blendColorState.r=t,this._blendColorState.g=e,this._blendColorState.b=i,this._blendColorState.a=n,this._stateTracker.invalidateBlending())}},{key:"setBlendFunction",value:function(t,e){t===this._blendFunctionState.srcRGB&&e===this._blendFunctionState.dstRGB||(this.gl.blendFunc(t,e),this._blendFunctionState.srcRGB=t,this._blendFunctionState.srcAlpha=t,this._blendFunctionState.dstRGB=e,this._blendFunctionState.dstAlpha=e,this._stateTracker.invalidateBlending())}},{key:"setBlendFunctionSeparate",value:function(t,e,i,n){this._blendFunctionState.srcRGB===t&&this._blendFunctionState.srcAlpha===i&&this._blendFunctionState.dstRGB===e&&this._blendFunctionState.dstAlpha===n||(this.gl.blendFuncSeparate(t,e,i,n),this._blendFunctionState.srcRGB=t,this._blendFunctionState.srcAlpha=i,this._blendFunctionState.dstRGB=e,this._blendFunctionState.dstAlpha=n,this._stateTracker.invalidateBlending())}},{key:"setBlendEquation",value:function(t){this._blendEquationState.mode!==t&&(this.gl.blendEquation(t),this._blendEquationState.mode=t,this._blendEquationState.modeAlpha=t,this._stateTracker.invalidateBlending())}},{key:"setBlendEquationSeparate",value:function(t,e){this._blendEquationState.mode===t&&this._blendEquationState.modeAlpha===e||(this.gl.blendEquationSeparate(t,e),this._blendEquationState.mode=t,this._blendEquationState.modeAlpha=e,this._stateTracker.invalidateBlending())}},{key:"setColorMask",value:function(t,e,i,n){this._colorMaskState.r===t&&this._colorMaskState.g===e&&this._colorMaskState.b===i&&this._colorMaskState.a===n||(this.gl.colorMask(t,e,i,n),this._colorMaskState.r=t,this._colorMaskState.g=e,this._colorMaskState.b=i,this._colorMaskState.a=n,this._stateTracker.invalidateColorWrite())}},{key:"setClearColor",value:function(t,e,i,n){this._clearColor.r===t&&this._clearColor.g===e&&this._clearColor.b===i&&this._clearColor.a===n||(this.gl.clearColor(t,e,i,n),this._clearColor.r=t,this._clearColor.g=e,this._clearColor.b=i,this._clearColor.a=n)}},{key:"setFaceCullingEnabled",value:function(t){this._polygonCullingEnabled!==t&&(!0===t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=t,this._stateTracker.invalidateCulling())}},{key:"setPolygonOffsetFillEnabled",value:function(t){this._polygonOffsetFillEnabled!==t&&(!0===t?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=t,this._stateTracker.invalidatePolygonOffset())}},{key:"setPolygonOffset",value:function(t,e){this._polygonOffset[0]===t&&this._polygonOffset[1]===e||(this._polygonOffset[0]=t,this._polygonOffset[1]=e,this.gl.polygonOffset(t,e),this._stateTracker.invalidatePolygonOffset())}},{key:"setCullFace",value:function(t){this._cullFace!==t&&(this.gl.cullFace(t),this._cullFace=t,this._stateTracker.invalidateCulling())}},{key:"setFrontFace",value:function(t){this._frontFace!==t&&(this.gl.frontFace(t),this._frontFace=t,this._stateTracker.invalidateCulling())}},{key:"setScissorTestEnabled",value:function(t){this._scissorTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=t)}},{key:"setScissorRect",value:function(t,e,i,n){this._scissorRect.x===t&&this._scissorRect.y===e&&this._scissorRect.width===i&&this._scissorRect.height===n||(this.gl.scissor(t,e,i,n),this._scissorRect.x=t,this._scissorRect.y=e,this._scissorRect.width=i,this._scissorRect.height=n)}},{key:"setDepthTestEnabled",value:function(t){this._depthTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=t,this._stateTracker.invalidateDepthTest())}},{key:"setClearDepth",value:function(t){this._clearDepth!==t&&(this.gl.clearDepth(t),this._clearDepth=t)}},{key:"setDepthFunction",value:function(t){this._depthFunction!==t&&(this.gl.depthFunc(t),this._depthFunction=t,this._stateTracker.invalidateDepthTest())}},{key:"setDepthWriteEnabled",value:function(t){this._depthWriteEnabled!==t&&(this.gl.depthMask(t),this._depthWriteEnabled=t,this._stateTracker.invalidateDepthWrite())}},{key:"setDepthRange",value:function(t,e){this._depthRange.zNear===t&&this._depthRange.zFar===e||(this.gl.depthRange(t,e),this._depthRange.zNear=t,this._depthRange.zFar=e,this._stateTracker.invalidateDepthWrite())}},{key:"setStencilTestEnabled",value:function(t){this._stencilTestEnabled!==t&&(!0===t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=t,this._stateTracker.invalidateStencilTest())}},{key:"setClearStencil",value:function(t){t!==this._clearStencil&&(this.gl.clearStencil(t),this._clearStencil=t)}},{key:"setStencilFunction",value:function(t,e,i){this._stencilFunction.func===t&&this._stencilFunction.ref===e&&this._stencilFunction.mask===i||(this.gl.stencilFunc(t,e,i),this._stencilFunction.face=1032,this._stencilFunction.func=t,this._stencilFunction.ref=e,this._stencilFunction.mask=i,this._stateTracker.invalidateStencilTest())}},{key:"setStencilFunctionSeparate",value:function(t,e,i,n){this._stencilFunction.face===t&&this._stencilFunction.func===e&&this._stencilFunction.ref===i&&this._stencilFunction.mask===n||(this.gl.stencilFuncSeparate(t,e,i,n),this._stencilFunction.face=t,this._stencilFunction.func=e,this._stencilFunction.ref=i,this._stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())}},{key:"setStencilWriteMask",value:function(t){this._stencilWriteMask!==t&&(this.gl.stencilMask(t),this._stencilWriteMask=t,this._stateTracker.invalidateStencilWrite())}},{key:"setStencilOp",value:function(t,e,i){this._stencilOperation.fail===t&&this._stencilOperation.zFail===e&&this._stencilOperation.zPass===i||(this.gl.stencilOp(t,e,i),this._stencilOperation.face=1032,this._stencilOperation.fail=t,this._stencilOperation.zFail=e,this._stencilOperation.zPass=i,this._stateTracker.invalidateStencilTest())}},{key:"setStencilOpSeparate",value:function(t,e,i,n){this._stencilOperation.face===t&&this._stencilOperation.fail===e&&this._stencilOperation.zFail===i&&this._stencilOperation.zPass===n||(this.gl.stencilOpSeparate(t,e,i,n),this._stencilOperation.face=t,this._stencilOperation.face=t,this._stencilOperation.fail=e,this._stencilOperation.zFail=i,this._stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())}},{key:"setActiveTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._activeTextureUnit;return t>=0&&(e||t!==this._activeTextureUnit)&&(this.gl.activeTexture(o.a+t),this._activeTextureUnit=t),i}},{key:"clear",value:function(t){t&&this.gl.clear(t)}},{key:"clearSafe",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;t&&(16384&t&&this.setColorMask(!0,!0,!0,!0),256&t&&this.setDepthWriteEnabled(!0),1024&t&&this.setStencilWriteMask(e),this.gl.clear(t))}},{key:"drawArrays",value:function(t,e,i){T()&&(this._numOfDrawCalls++,this._numOfTriangles+=m(t,i)),this.gl.drawArrays(t,e,i)}},{key:"drawElements",value:function(t,e,i,n){T()&&(this._numOfDrawCalls++,this._numOfTriangles+=m(t,e)),this.gl.drawElements(t,e,i,n)}},{key:"logIno",value:function(){T()&&console.log("DrawCalls: ".concat(this._numOfDrawCalls,", Triangles: ").concat(this._numOfTriangles))}},{key:"capabilities",get:function(){return this._capabilities}},{key:"setViewport",value:function(t,e,i,n){i=Math.max(Math.round(i),1),n=Math.max(Math.round(n),1);var r=this._viewport;r.x===t&&r.y===e&&r.width===i&&r.height===n||(r.x=t,r.y=e,r.width=i,r.height=n,this.gl.viewport(t,e,i,n))}},{key:"getViewport",value:function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}}},{key:"useProgram",value:function(t){var e,i;if(!t)return null==(i=this._activeShaderProgram)||i.stop(),this._activeShaderProgram=null,void this.gl.useProgram(null);this._activeShaderProgram!==t&&(null==(e=this._activeShaderProgram)||e.stop(),this._activeShaderProgram=t,this.gl.useProgram(t.glName))}},{key:"bindTexture",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(e>=this.parameters.maxTextureImageUnits||e<0)&&console.error("Input texture unit is out of range of available units!");var n=this._textureUnitMap[e];return this.setActiveTexture(e,i),Object(s.h)(t)||null==t.glName?(Object(s.i)(n)&&this.gl.bindTexture(n.descriptor.target,null),this._textureUnitMap[e]=null,n):i||n!==t?(this.gl.bindTexture(t.descriptor.target,t.glName),t.applyChanges(),this._textureUnitMap[e]=t,n):(t.applyChanges(),n)}},{key:"unbindTextureAllUnits",value:function(t){for(var e=0;e<this.parameters.maxTextureImageUnits;e++)this._textureUnitMap[e]===t&&(this.bindTexture(null,e),this._textureUnitMap[e]=null)}},{key:"bindFramebuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(s.h)(t))return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null);(e||this._activeFramebuffer!==t)&&(t.initializeAndBind(),this._activeFramebuffer=t)}},{key:"bindBuffer",value:function(t){t&&(34962===t.bufferType?this._activeVertexBuffer=p(this.gl,t,t.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=p(this.gl,t,t.bufferType,this._activeIndexBuffer))}},{key:"bindRenderbuffer",value:function(t){var e=this.gl;t||(e.bindRenderbuffer(e.RENDERBUFFER,null),this._activeRenderbuffer=null),this._activeRenderbuffer!==t&&(e.bindRenderbuffer(e.RENDERBUFFER,t.glName),this._activeRenderbuffer=t)}},{key:"unbindBuffer",value:function(t){34962===t?this._activeVertexBuffer=p(this.gl,null,t,this._activeVertexBuffer):this._activeIndexBuffer=p(this.gl,null,t,this._activeIndexBuffer)}},{key:"bindVAO",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(s.h)(t)?this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null):this._activeVertexArrayObject!==t&&(t.bind(),this._activeVertexArrayObject=t)}},{key:"getBoundFramebufferObject",value:function(){return this._activeFramebuffer}},{key:"getBoundVAO",value:function(){return this._activeVertexArrayObject}},{key:"resetState",value:function(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null),this.unbindBuffer(34962),this.unbindBuffer(34963);for(var t=0;t<this.parameters.maxTextureImageUnits;++t)this.bindTexture(null,t);this.setBlendingEnabled(!1),this.setBlendFunction(1,0),this.setBlendEquation(32774),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(1029),this.setFrontFace(2305),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(513),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(519,0,0),this.setStencilOp(7680,7680,7680),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}},{key:"enforceState",value:function(){var t=this.gl,e=this.capabilities.vao;e&&e.bindVertexArray(null);for(var i=0;i<this.parameters.maxVertexAttributes;i++)t.disableVertexAttribArray(i);if(this._activeVertexBuffer?t.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):t.bindBuffer(34962,null),this._activeIndexBuffer?t.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):t.bindBuffer(34963,null),e&&this._activeVertexArrayObject){var n=this._activeVertexArrayObject;this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(n)}t.bindFramebuffer(t.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null),t.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null),t.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a),t.bindRenderbuffer(t.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null),!0===this._blendEnabled?t.enable(this.gl.BLEND):t.disable(this.gl.BLEND),t.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha),t.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha),t.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),t.clearDepth(this._clearDepth),t.clearStencil(this._clearStencil),t.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a),t.cullFace(this._cullFace),t.depthFunc(this._depthFunction),t.depthRange(this._depthRange.zNear,this._depthRange.zFar),!0===this._depthTestEnabled?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),t.depthMask(this._depthWriteEnabled),t.frontFace(this._frontFace),t.lineWidth(1),!0===this._polygonCullingEnabled?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]),!0===this._polygonOffsetFillEnabled?t.enable(t.POLYGON_OFFSET_FILL):t.disable(t.POLYGON_OFFSET_FILL),t.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height),!0===this._scissorTestEnabled?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),t.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask),t.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass),!0===this._stencilTestEnabled?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),t.stencilMask(this._stencilWriteMask);for(var r=0;r<this.parameters.maxTextureImageUnits;r++){t.activeTexture(o.a+r),t.bindTexture(3553,null),Object(h.a)(t)&&t.bindTexture(32879,null);var a=this._textureUnitMap[r];Object(s.i)(a)&&t.bindTexture(a.descriptor.target,a.glName)}t.activeTexture(o.a+this._activeTextureUnit),t.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height),T()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}},{key:"_loadParameters",value:function(t){var e,i=this.capabilities.textureFilterAnisotropic,n=null!=(e=t.maxAnisotropy)?e:1/0,r={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:i?Math.min(this.gl.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY),n):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)};return u.a.TEXTURE_UNIT_FOR_UPDATES=r.maxTextureImageUnits-1,r}}]),t}();function p(t,e,i,n){return e?n!==e&&t.bindBuffer(i,e.glName):t.bindBuffer(i,null),e}function m(t,e){switch(t){case 0:return 2*e;case 4:return e/3;case 5:case 6:return e-2;default:return 0}}var b=!!Object(a.a)("enable-feature:webgl-debug");function T(){return b}function x(){return b}e.a=v},530:function(t,e,i){"use strict";var n=i(11),r=i(2),a=i(3),s=i(9),o=i(527),l=i(706),c=i(529),u=i(526),h=i(707),f=s.a.getLogger("esri.views.webgl.FrameBufferObject"),_=function(){function t(e,i,a,s){if(Object(r.a)(this,t),this._context=e,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachments=new Map,this._initialized=!1,this._desc=Object(n.a)({},i),e.instanceCounter.increment(o.b.Framebuffer,this),a){Array.isArray(a)||(a=[a]);for(var c=0;c<a.length;++c){var h,f=a[c],_=void 0;d(f)?(_=f.descriptor,this._colorAttachments.set(36064+c,f)):(_=f,this._colorAttachments.set(36064+c,new u.a(e,f))),0!==(null==(h=this._desc)?void 0:h.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),this._validateColorAttachmentPoint(36064+c),this._validateTextureDimensions(_,this._desc)}}if(s instanceof l.a){var v,p=null!=(v=this._desc.depthStencilTarget)?v:3;2===p?this._stencilAttachment=s:1===p||3===p?this._depthAttachment=s:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),g(s.descriptor,this._desc)}else if(s){var m;this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),d(s)?(this._depthStencilTexture=s,m=s.descriptor):this._depthStencilTexture=new u.a(this._context,s),this._validateTextureDimensions(m,this._desc)}}return Object(a.a)(t,[{key:"dispose",value:function(){if(this._desc){var t=this._context.getBoundFramebufferObject();this._disposeColorAttachments(),this._disposeDepthStencilAttachments(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(t),this._context.instanceCounter.decrement(o.b.Framebuffer,this),this._desc=null}}},{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._desc}},{key:"colorTexture",get:function(){var t=this._colorAttachments.get(36064);return t&&d(t)?t:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(36064)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},{key:"height",get:function(){return this._desc.height}},{key:"gpuMemoryUsage",get:function(){return Object(h.c)(this.colorAttachment)+Object(h.c)(this.depthStencilAttachment)}},{key:"getColorTexture",value:function(t){var e=this._colorAttachments.get(t);return e&&d(e)?e:null}},{key:"attachColorTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36064;if(t){this._validateColorAttachmentPoint(e);var i=t.descriptor;if(this._validateTextureDimensions(i,this._desc),this._disposeColorAttachments(),this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,e,n.TEXTURE_2D,t.glName,0)}this._colorAttachments.set(e,t)}}},{key:"detachColorTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=this._colorAttachments.get(t);if(d(e)){var i=e;if(this._initialized){this._context.bindFramebuffer(this);var n=this._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,t,n.TEXTURE_2D,null,0)}return this._colorAttachments.delete(t),i}}},{key:"attachDepthStencilTexture",value:function(t){if(t){var e=t.descriptor;if(34041!==e.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==e.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDimensions(e,this._desc),this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,t.glName,0)}this._depthStencilTexture=t}}},{key:"detachDepthStencilTexture",value:function(){var t=this._depthStencilTexture;if(t&&this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,t}},{key:"attachDepthStencilBuffer",value:function(t){if(t){var e=t.descriptor;if(34041!==e.internalFormat&&33189!==e.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat"),g(e,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===e.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl,n=1===this._desc.depthStencilTarget?i.DEPTH_ATTACHMENT:i.DEPTH_STENCIL_ATTACHMENT;i.framebufferRenderbuffer(i.FRAMEBUFFER,n,i.RENDERBUFFER,t.glName)}this._depthAttachment=t}}},{key:"detachDepthStencilBuffer",value:function(){var t=this._context.gl,e=this._depthAttachment;if(e&&this._initialized){this._context.bindFramebuffer(this);var i=1===this._desc.depthStencilTarget?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT;t.framebufferRenderbuffer(t.FRAMEBUFFER,i,t.RENDERBUFFER,null)}return this._depthAttachment=null,e}},{key:"detachAll",value:function(){this.detachColorTexture(),this.detachDepthStencilBuffer(),this.detachDepthStencilTexture()}},{key:"copyToTexture",value:function(t,e,i,n,r,a,s){(t<0||e<0||r<0||a<0)&&console.error("Offsets cannot be negative!"),(i<=0||n<=0)&&console.error("Copy width and height must be greater than zero!");var o=this._desc,l=s.descriptor;3553!==s.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(t+i>o.width||e+n>o.height||r+i>l.width||a+n>l.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var c=this._context,h=c.bindTexture(s,u.a.TEXTURE_UNIT_FOR_UPDATES);c.bindFramebuffer(this),c.gl.copyTexSubImage2D(3553,0,r,a,t,e,i,n),c.bindTexture(h,u.a.TEXTURE_UNIT_FOR_UPDATES)}},{key:"readPixels",value:function(t,e,i,n,r,a,s){(i<=0||n<=0)&&console.error("Copy width and height must be greater than zero!"),s||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(t,e,i,n,r,a,s)}},{key:"resize",value:function(t,e){var i=this._desc;if(i.width!==t||i.height!==e){if(!this._initialized)return i.width=t,i.height=e,this._colorAttachments.forEach((function(i){i&&i.resize(t,e)})),void(this._depthStencilTexture&&this._depthStencilTexture.resize(t,e));i.width=t,i.height=e,this._colorAttachments.forEach((function(i){i&&i.resize(t,e)})),null!=this._depthStencilTexture?this._depthStencilTexture.resize(t,e):(this._depthAttachment||this._stencilAttachment)&&(this._depthAttachment&&this._depthAttachment.resize(t,e),this._stencilAttachment&&this._stencilAttachment.resize(t,e)),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}}},{key:"initializeAndBind",value:function(){var t,e,i,n,r=this._context.gl;if(this._initialized)r.bindFramebuffer(r.FRAMEBUFFER,this.glName);else{this._glName&&r.deleteFramebuffer(this._glName);var a=this._context,s=r.createFramebuffer(),o=this._desc,h=null!=(t=o.colorTarget)?t:1,f=null!=(e=o.width)?e:1,_=null!=(i=o.height)?i:1;if(r.bindFramebuffer(r.FRAMEBUFFER,s),0===this._colorAttachments.size)if(0===h)this._colorAttachments.set(36064,function(t,e){return new u.a(t,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height})}(a,o));else{var g=new l.a(a,{internalFormat:32854,width:f,height:_});this._colorAttachments.set(36064,g)}this._colorAttachments.forEach((function(t,e){t&&(d(t)?r.framebufferTexture2D(r.FRAMEBUFFER,e,r.TEXTURE_2D,t.glName,0):r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,t.glName))}));var v=null!=(n=o.depthStencilTarget)?n:0;switch(v){case 1:case 3:this._depthAttachment||(this._depthAttachment=new l.a(a,{internalFormat:1===o.depthStencilTarget?33189:34041,width:f,height:_}));var p=1===v?r.DEPTH_ATTACHMENT:r.DEPTH_STENCIL_ATTACHMENT;r.framebufferRenderbuffer(r.FRAMEBUFFER,p,r.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new l.a(a,{internalFormat:36168,width:f,height:_})),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.STENCIL_ATTACHMENT,r.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){a.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var m={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:f,height:_};this._depthStencilTexture=new u.a(a,m)}r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,this._depthStencilTexture.glName,0)}Object(c.c)()&&r.checkFramebufferStatus(r.FRAMEBUFFER)!==r.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=s,this._initialized=!0}}},{key:"_disposeColorAttachments",value:function(){var t=this;this._colorAttachments.forEach((function(e,i){if(d(e)){if(t._initialized){t._context.bindFramebuffer(t);var n=t._context.gl;n.framebufferTexture2D(n.FRAMEBUFFER,i,n.TEXTURE_2D,null,0)}e.dispose()}else if(e instanceof WebGLRenderbuffer){var r=t._context.gl;t._initialized&&(t._context.bindFramebuffer(t),r.framebufferRenderbuffer(r.FRAMEBUFFER,i,r.RENDERBUFFER,null)),t._context.gl.deleteRenderbuffer(e)}})),this._colorAttachments.clear()}},{key:"_disposeDepthStencilAttachments",value:function(){var t=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var e=1===this._desc.depthStencilTarget?t.DEPTH_ATTACHMENT:t.DEPTH_STENCIL_ATTACHMENT;t.framebufferRenderbuffer(t.FRAMEBUFFER,e,t.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.STENCIL_ATTACHMENT,t.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)}},{key:"_validateTextureDimensions",value:function(t,e){3553!==t.target&&console.error("Texture type must be TEXTURE_2D!"),void 0!==e.width&&e.width>=0&&void 0!==e.height&&e.height>=0?e.width===t.width&&e.height===t.height||console.error("Color attachment texture must match the framebuffer's!"):(e.width=t.width,e.height=t.height)}},{key:"_validateColorAttachmentPoint",value:function(e){if(-1===t._MAX_COLOR_ATTACHMENTS){var i=this._context.capabilities.drawBuffers;if(i){var n=this._context.gl;t._MAX_COLOR_ATTACHMENTS=n.getParameter(i.MAX_COLOR_ATTACHMENTS)}else t._MAX_COLOR_ATTACHMENTS=1}var r=e-36064;r+1>t._MAX_COLOR_ATTACHMENTS&&f.error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(r+1,". Implementation supports up to ").concat(t._MAX_COLOR_ATTACHMENTS," color attachments"))}}]),t}();function d(t){return"type"in t&&"texture"===t.type}function g(t,e){void 0!==e.width&&e.width>=0&&void 0!==e.height&&e.height>=0?e.width===t.width&&e.height===t.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(e.width=t.width,e.height=t.height)}_._MAX_COLOR_ATTACHMENTS=-1,e.a=_},531:function(t,e,i){"use strict";var n=i(2),r=i(3),a=i(9),s=i(8),o=i(527),l=i(707),c=a.a.getLogger("esri.views.webgl.VertexArrayObject"),u=function(){function t(e,i,r,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(n.a)(this,t),this._context=e,this._locations=i,this._layout=r,this._buffers=a,this._indexBuffer=s,this._glName=null,this._initialized=!1,e.instanceCounter.increment(o.b.VAO,this)}return Object(r.a)(t,[{key:"glName",get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){var t=this;return Object.keys(this._buffers).reduce((function(e,i){return e+t._buffers[i].size}),Object(s.i)(this._indexBuffer)?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}},{key:"dispose",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){var e,i,n=null==(e=this._context)||null==(i=e.capabilities)?void 0:i.vao;n?(n.deleteVertexArray(this._glName),this._glName=null):c.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),t){for(var r in this._buffers)this._buffers[r].dispose(),delete this._buffers[r];this._indexBuffer=Object(s.e)(this._indexBuffer)}this._context.instanceCounter.decrement(o.b.VAO,this),this._context=null}else(this._glName||t&&Object.getOwnPropertyNames(this._buffers).length>0)&&c.warn("Leaked WebGL VAO")}},{key:"initialize",value:function(){if(!this._initialized){var t=this._context.capabilities.vao;if(t){var e=t.createVertexArray();t.bindVertexArray(e),this._bindLayout(),t.bindVertexArray(null),this._glName=e}this._initialized=!0}}},{key:"bind",value:function(){this.initialize();var t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}},{key:"_bindLayout",value:function(){var t=this._buffers,e=this._layout,i=this._indexBuffer;t||c.error("Vertex buffer dictionary is empty!");var n=this._context.gl;for(var r in t){var a=t[r];a||c.error("Vertex buffer is uninitialized!");var o=e[r];o||c.error("Vertex element descriptor is empty!"),Object(l.a)(this._context,this._locations,a,o)}Object(s.i)(i)&&(this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}},{key:"unbind",value:function(){this.initialize();var t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()}},{key:"_unbindLayout",value:function(){var t=this._buffers,e=this._layout;for(var i in t||c.error("Vertex buffer dictionary is empty!"),t){var n=t[i];n||c.error("Vertex buffer is uninitialized!");var r=e[i];Object(l.d)(this._context,this._locations,n,r)}Object(s.i)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}]),t}();e.a=u},532:function(t,e,i){"use strict";var n=i(2),r=i(3),a=i(9),s=i(144),o=i(20),l=i(529),c=a.a.getLogger("esri/views/webgl");function u(t){if(Object(l.b)()){var e=t.getError();if(e){var i=function(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(t,e),n=(new Error).stack;c.error(new o.a("webgl-error","WebGL error occured",{message:i,stack:n}))}}}var h=i(527),f=a.a.getLogger("esri.views.webgl.BufferObject"),_=function(){function t(e,i,r,a,s){Object(n.a)(this,t),this._context=e,this.bufferType=i,this.usage=r,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(h.b.Buffer,this),this._glName=this._context.gl.createBuffer(),u(this._context.gl),a&&this.setData(a,s)}return Object(r.a)(t,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}},{key:"dispose",value:function(){var t;null!=(t=this._context)&&t.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(h.b.Buffer,this),this._context=null):this._glName&&f.warn("Leaked WebGL buffer object")}},{key:"setData",value:function(t,e){if(t){if("number"==typeof t){if(t<0&&f.error("Buffer size cannot be negative!"),34963===this.bufferType&&e)switch(this._indexType=e,this._size=t,e){case 5123:t*=2;break;case 5125:t*=4}}else{var i=t.byteLength;Object(s.i)(t)&&(i/=2,this._indexType=5123),Object(s.j)(t)&&(i/=4,this._indexType=5125),this._size=i}var n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var r=this._context.gl;r.bufferData(this.bufferType,t,this.usage),u(r),this._context.bindVAO(n)}}},{key:"setSubData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.byteLength;if(t){(e<0||e>=this._size)&&f.error("offset is out of range!");var r=e,a=i,o=n,l=t.byteLength;Object(s.i)(t)&&(l/=2,r*=2,a*=2,o*=2),Object(s.j)(t)&&(l/=4,r*=4,a*=4,o*=4),void 0===n&&(n=l-1),i>=n&&f.error("end must be bigger than start!"),e+i-n>this._size&&f.error("An attempt to write beyond the end of the buffer!");var c=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var h=this._context.gl,_=ArrayBuffer.isView(t)?t.buffer:t,d=0===a&&o===t.byteLength?_:_.slice(a,o);h.bufferSubData(this.bufferType,r,d),u(h),this._context.bindVAO(c)}}}],[{key:"createIndex",value:function(e,i,n,r){return new t(e,34963,i,n,r)}},{key:"createVertex",value:function(e,i,n){return new t(e,34962,i,n)}}]),t}();e.a=_},533:function(t,e,i){"use strict";i.d(e,"a",(function(){return u})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return l}));var n,r={exports:{}};void 0!==(n=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(r.exports=n);var a,s=r.exports,o={exports:{}};a=o,function(t){var e=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"];void 0!==e&&(a.exports=e)}();var l=o.exports,c={exports:{}};!function(t){!function(e){var i=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"];void 0!==i&&(t.exports=i)}()}(c);var u=c.exports},638:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n=i(2),r=i(3),a=(i(10),i(8)),s=i(527),o=i(529),l=i(15),c=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],u=i(533),h=999,f=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function _(){var t,e,i,n=0,r=0,a=h,s=[],o=[],l=1,c=0,_=0,d=!1,g=!1,v="";return function(t){return o=[],null!==t?m(t.replace?t.replace(/\r\n/g,"\n"):t):(s.length&&p(s.join("")),a=10,p("(eof)"),o)};function p(t){t.length&&o.push({type:f[a],data:t,position:_,line:l,column:c})}function m(u){var f;for(n=0,i=(v+=u).length;t=v[n],n<i;){switch(f=n,a){case 0:n="/"===t&&"*"===e?(s.push(t),p(s.join("")),a=h,n+1):(s.push(t),e=t,n+1);break;case 1:case 2:n=b();break;case 3:n=T();break;case 4:n="."===t||/[eE]/.test(t)?(s.push(t),a=5,e=t,n+1):"x"===t&&1===s.length&&"0"===s[0]?(a=11,s.push(t),e=t,n+1):/[^\d]/.test(t)?(p(s.join("")),a=h,n):(s.push(t),e=t,n+1);break;case 11:n=/[^a-fA-F0-9]/.test(t)?(p(s.join("")),a=h,n):(s.push(t),e=t,n+1);break;case 5:"f"===t&&(s.push(t),e=t,n+=1),n=/[eE]/.test(t)||"-"===t&&/[eE]/.test(e)?(s.push(t),e=t,n+1):/[^\d]/.test(t)?(p(s.join("")),a=h,n):(s.push(t),e=t,n+1);break;case 9999:n=E();break;case 9:n=/[^\s]/g.test(t)?(p(s.join("")),a=h,n):(s.push(t),e=t,n+1);break;case h:s=s.length?[]:s,n="/"===e&&"*"===t?(_=r+n-1,a=0,e=t,n+1):"/"===e&&"/"===t?(_=r+n-1,a=1,e=t,n+1):"#"===t?(a=2,_=r+n,n):/\s/.test(t)?(a=9,_=r+n,n):(d=/\d/.test(t),g=/[^\w_]/.test(t),_=r+n,a=d?4:g?3:9999,n)}if(f!==n)switch(v[f]){case"\n":c=0,++l;break;default:++c}}return r+=n,v=v.slice(n),o}function b(){return"\r"!==t&&"\n"!==t||"\\"===e?(s.push(t),e=t,n+1):(p(s.join("")),a=h,n)}function T(){if("."===e&&/\d/.test(t))return a=5,n;if("/"===e&&"*"===t)return a=0,n;if("/"===e&&"/"===t)return a=1,n;if("."===t&&s.length){for(;x(s););return a=5,n}if(";"===t||")"===t||"("===t){if(s.length)for(;x(s););return p(t),a=h,n+1}var i=2===s.length&&"="!==t;if(/[\w_\d\s]/.test(t)||i){for(;x(s););return a=h,n}return s.push(t),e=t,n+1}function x(t){for(var e,i,n=0;;){if(e=u.c.indexOf(t.slice(0,t.length+n).join("")),i=u.c[e],-1===e){if(n--+t.length>0)continue;i=t.slice(0,1).join("")}return p(i),_+=i.length,(s=s.slice(i.length)).length}}function E(){if(/[^\d\w_]/.test(t)){var i=s.join("");return a=u.b.indexOf(i)>-1?8:u.a.indexOf(i)>-1?7:6,p(s.join("")),a=h,n}return s.push(t),e=t,n+1}}function d(t){return function(t){var e=_(),i=[];return(i=i.concat(e(t))).concat(e(null))}(t)}var g=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];function v(t,e){for(var i=e-1;i>=0;i--){var n=t[i];if("whitespace"!==n.type&&"block-comment"!==n.type){if("keyword"!==n.type)break;if("attribute"===n.data||"in"===n.data)return!0}}return!1}function p(t,e,i,n){n=n||i;var r,a=Object(l.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;if("ident"===s.type&&s.data===i)return n in e?e[n]++:e[n]=0,p(t,e,n+"_"+e[n],n)}}catch(o){a.e(o)}finally{a.f()}return i}function m(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"afterVersion";function n(t,e){for(var i=e;i<t.length;i++){var n=t[i];if("operator"===n.type&&";"===n.data)return i}return null}function r(t){for(var e=-1,r=0,a=-1,s=0;s<t.length;s++){var o=t[s];if("preprocessor"===o.type&&(o.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++r:o.data.match(/\#endif\s*.*/)&&--r),"afterVersion"!==i&&"afterPrecision"!==i||"preprocessor"===o.type&&/^#version/.test(o.data)&&(a=Math.max(a,s)),"afterPrecision"===i&&"keyword"===o.type&&"precision"===o.data){var l=n(t,s);if(null===l)throw new Error("precision statement not followed by any semicolons!");a=Math.max(a,l)}e<a&&0===r&&(e=s)}return e+1}var a={data:"\n",type:"whitespace"},s=function(e){return e<t.length&&/[^\r\n]$/.test(t[e].data)},o=r(t);s(o-1)&&t.splice(o++,0,a);var c,u=Object(l.a)(e);try{for(u.s();!(c=u.n()).done;){var h=c.value;t.splice(o++,0,h)}}catch(f){u.e(f)}finally{u.f()}s(o-1)&&s(o)&&t.splice(o,0,a)}function b(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lowp";m(t,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"ident",data:e},{type:"operator",data:";"}],"afterPrecision")}function T(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"lowp";m(t,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:n.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"ident",data:e},{type:"operator",data:";"}],"afterPrecision")}function x(t,e){for(var i,n,r=-1,a=e;a<t.length;a++){var s=t[a];if("operator"===s.type&&("["===s.data&&(i=a),"]"===s.data)){n=a;break}"integer"===s.type&&(r=parseInt(s.data,10))}return i&&n&&t.splice(i,n-i+1),r}function E(t,e){var i=d(t);if("300 es"===function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"300 es",r=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,a=Object(l.a)(t);try{for(a.s();!(e=a.n()).done;){var s=e.value;if("preprocessor"===s.type){var o=r.exec(s.data);if(o){var c=o[1].replace(/\s\s+/g," ");if(c===n)return c;if(c===i)return s.data="#version "+n,i;throw new Error("unknown glsl version: "+c)}}}}catch(u){a.e(u)}finally{a.f()}return t.splice(0,0,{type:"preprocessor",data:"#version "+n},{type:"whitespace",data:"\n"}),null}(i,"100","300 es"))throw new Error("shader is already glsl 300 es");for(var n=null,r=null,a={},s={},o=0;o<i.length;++o){var u=i[o];switch(u.type){case"keyword":35633===e&&"attribute"===u.data?u.data="in":"varying"===u.data&&(u.data=35633===e?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(u.data.trim())&&(u.data=u.data.replace(/(2D|Cube|EXT)/g,"")),35632===e&&"gl_FragColor"===u.data&&(n||b(i,n=p(i,a,"fragColor"),"vec4"),u.data=n),35632===e&&"gl_FragData"===u.data){var h=x(i,o+1),f=p(i,a,"fragData");T(i,f,"vec4",h,"mediump"),u.data=f}else 35632===e&&"gl_FragDepthEXT"===u.data&&(r||(r=p(i,a,"gl_FragDepth")),u.data=r);break;case"ident":if(c.indexOf(u.data)>=0){if(35633===e&&v(i,o))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");u.data in s||(s[u.data]=p(i,a,u.data)),u.data=s[u.data]}}}for(var _=i.length-1;_>=0;--_){var m=i[_];if("preprocessor"===m.type){var E=m.data.match(/\#extension\s+(.*)\:/);if(E&&E[1]&&g.indexOf(E[1].trim())>=0){var y=i[_+1];i.splice(_,y&&"whitespace"===y.type?2:1)}var S=m.data.match(/\#ifdef\s+(.*)/);S&&S[1]&&g.indexOf(S[1].trim())>=0&&(m.data="#if 1");var A=m.data.match(/\#ifndef\s+(.*)/);A&&A[1]&&g.indexOf(A[1].trim())>=0&&(m.data="#if 0")}}return i.map((function(t){return"eof"!==t.type?t.data:""})).join("")}var y=function(){function t(e,i,r,a){Object(n.a)(this,t),this._context=e,this._locations=a,this._vShader=null,this._fShader=null,this._nameToUniformLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},e||console.error("RenderingContext isn't initialized!"),0===i.length&&console.error("Shaders source should not be empty!"),this._vShader=A(this._context,35633,i),this._fShader=A(this._context,35632,r),this._vShader&&this._fShader||console.error("Error loading shaders!");var l=this._context.gl,c=l.createProgram();l.attachShader(c,this._vShader),l.attachShader(c,this._fShader),a.forEach((function(t,e){return l.bindAttribLocation(c,t,e)})),l.linkProgram(c),Object(o.c)()&&!l.getProgramParameter(c,l.LINK_STATUS)&&console.error("Could not initialize shader\nVALIDATE_STATUS: "+l.getProgramParameter(c,l.VALIDATE_STATUS)+", gl error ["+l.getError()+"]infoLog: "+l.getProgramInfoLog(c)),this._glName=c,this._context.instanceCounter.increment(s.b.Program,this)}return Object(r.a)(t,[{key:"glName",get:function(){return this._glName}},{key:"dispose",value:function(){var t=this._context.gl;if(this._vShader){var e=this._vShader;t.deleteShader(e),this._vShader=null}if(this._fShader){var i=this._fShader;t.deleteShader(i),this._fShader=null}this._glName&&(t.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(s.b.Program,this))}},{key:"_getUniformLocation",value:function(t){return void 0===this._nameToUniformLocation[t]&&(this._nameToUniformLocation[t]=this._context.gl.getUniformLocation(this._glName,t)),this._nameToUniformLocation[t]}},{key:"hasUniform",value:function(t){return null!==this._getUniformLocation(t)}},{key:"setUniform1i",value:function(t,e){var i=this._nameToUniform1[t];void 0!==i&&e===i||(this._context.useProgram(this),this._context.gl.uniform1i(this._getUniformLocation(t),e),this._nameToUniform1[t]=e)}},{key:"setUniform1iv",value:function(t,e){var i=this._nameToUniform1v[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform1iv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform1v[t]=Array.from(e):F(e,i))}},{key:"setUniform2iv",value:function(t,e){var i=this._nameToUniform2[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform2iv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform2[t]=Array.from(e):F(e,i))}},{key:"setUniform3iv",value:function(t,e){var i=this._nameToUniform3[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform3iv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform3[t]=Array.from(e):F(e,i))}},{key:"setUniform4iv",value:function(t,e){var i=this._nameToUniform4[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform4iv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform4[t]=Array.from(e):F(e,i))}},{key:"setUniform1f",value:function(t,e){var i=this._nameToUniform1[t];void 0!==i&&e===i||(this._context.useProgram(this),this._context.gl.uniform1f(this._getUniformLocation(t),e),this._nameToUniform1[t]=e)}},{key:"setUniform1fv",value:function(t,e){var i=this._nameToUniform1v[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform1fv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform1v[t]=Array.from(e):F(e,i))}},{key:"setUniform2f",value:function(t,e,i){var n=this._nameToUniform2[t];void 0!==n&&e===n[0]&&i===n[1]||(this._context.useProgram(this),this._context.gl.uniform2f(this._getUniformLocation(t),e,i),void 0===n?this._nameToUniform2[t]=[e,i]:(n[0]=e,n[1]=i))}},{key:"setUniform2fv",value:function(t,e){var i=this._nameToUniform2[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform2fv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform2[t]=Array.from(e):F(e,i))}},{key:"setUniform3f",value:function(t,e,i,n){var r=this._nameToUniform3[t];void 0!==r&&e===r[0]&&i===r[1]&&n===r[2]||(this._context.useProgram(this),this._context.gl.uniform3f(this._getUniformLocation(t),e,i,n),void 0===r?this._nameToUniform3[t]=[e,i,n]:(r[0]=e,r[1]=i,r[2]=n))}},{key:"setUniform3fv",value:function(t,e){var i=this._nameToUniform3[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform3fv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform3[t]=Array.from(e):F(e,i))}},{key:"setUniform4f",value:function(t,e,i,n,r){var a=this._nameToUniform4[t];void 0!==a&&e===a[0]&&i===a[1]&&n===a[2]&&r===a[3]||(this._context.useProgram(this),this._context.gl.uniform4f(this._getUniformLocation(t),e,i,n,r),void 0===a?this._nameToUniform4[t]=[e,i,n,r]:(a[0]=e,a[1]=i,a[2]=n,a[3]=r))}},{key:"setUniform4fv",value:function(t,e){var i=this._nameToUniform4[t];S(i,e)&&(this._context.useProgram(this),this._context.gl.uniform4fv(this._getUniformLocation(t),e),void 0===i?this._nameToUniform4[t]=Array.from(e):F(e,i))}},{key:"setUniformMatrix3fv",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._nameToUniformMatrix3[t];R(n,e)&&(this._context.useProgram(this),this._context.gl.uniformMatrix3fv(this._getUniformLocation(t),i,e),void 0===n?this._nameToUniformMatrix3[t]=Array.from(e):F(e,n))}},{key:"setUniformMatrix4fv",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._nameToUniformMatrix4[t];O(n,e)&&(this._context.useProgram(this),this._context.gl.uniformMatrix4fv(this._getUniformLocation(t),i,e),void 0===n?this._nameToUniformMatrix4[t]=Array.from(e):F(e,n))}},{key:"assertCompatibleVertexAttributeLocations",value:function(t){t.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}},{key:"stop",value:function(){}}]),t}();function S(t,e){if(Object(a.h)(t)||t.length!==e.length)return!0;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!0;return!1}function A(t,e,i){var n="webgl2"===t.webglVersion?E(i,e):i,r=t.gl,a=r.createShader(e);return r.shaderSource(a,n),r.compileShader(a),Object(o.c)()&&!r.getShaderParameter(a,r.COMPILE_STATUS)&&(console.error("Compile error in ".concat(35633===e?"vertex":"fragment"," shader")),console.error(r.getShaderInfoLog(a)),console.error(function(t){var e=2;return t.replace(/\n/g,(function(){return"\n"+function(t){return t>=1e3?t.toString():("  "+t).slice(-3)}(e++)+":"}))}(n)),"webgl2"===t.webglVersion&&(console.log("Shader source before transpilation:"),console.log(i))),a}function F(t,e){for(var i=0;i<t.length;++i)e[i]=t[i]}function R(t,e){return!!Object(a.h)(t)||(9!==t.length?S(t,e):9!==t.length||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[7]!==e[7]||t[8]!==e[8])}function O(t,e){return!!Object(a.h)(t)||(16!==t.length?S(t,e):16!==t.length||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[7]!==e[7]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]||t[11]!==e[11]||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[15]!==e[15])}},706:function(t,e,i){"use strict";var n=i(2),r=i(3),a=i(527),s=function(){function t(e,i){Object(n.a)(this,t),this._context=e,this._desc=i,this._context.instanceCounter.increment(a.b.Renderbuffer,this);var r=this._context.gl;this.glName=r.createRenderbuffer(),this._context.bindRenderbuffer(this),r.renderbufferStorage(r.RENDERBUFFER,i.internalFormat,i.width,i.height)}return Object(r.a)(t,[{key:"descriptor",get:function(){return this._desc}},{key:"resize",value:function(t,e){var i=this._desc;if(i.width!==t||i.height!==e){i.width=t,i.height=e;var n=this._context.gl;this._context.bindRenderbuffer(this),n.renderbufferStorage(n.RENDERBUFFER,i.internalFormat,i.width,i.height)}}},{key:"dispose",value:function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(a.b.Renderbuffer,this),this._context=null)}}]),t}();e.a=s},707:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return l})),i.d(e,"c",(function(){return c})),i.d(e,"d",(function(){return o})),i.d(e,"e",(function(){return a}));var n=i(15),r=(i(10),i(8));function a(t,e){return t.vertexBuffers[e].size/function(t){return t[0].stride}(t.layout[e])}function s(t,e,i,r,a){var s=t.gl,o=t.capabilities.instancing;t.bindBuffer(i);var l,c=Object(n.a)(r);try{for(c.s();!(l=c.n()).done;){var u=l.value,h=e.get(u.name);void 0===h&&console.error("There is no location for vertex attribute '".concat(u.name,"' defined.")),u.baseInstance&&!u.divisor&&console.error("Vertex attribute '".concat(u.name,"' uses baseInstanceOffset without divisor."));var f=(a||(0+u.baseInstance?u.baseInstance:0))*u.stride;if(u.count<=4)s.vertexAttribPointer(h,u.count,u.type,u.normalized,u.stride,u.offset+f),s.enableVertexAttribArray(h),u.divisor>0&&o&&o.vertexAttribDivisor(h,u.divisor);else if(9===u.count)for(var _=0;_<3;_++)s.vertexAttribPointer(h+_,3,u.type,u.normalized,u.stride,u.offset+12*_+f),s.enableVertexAttribArray(h+_),u.divisor>0&&o&&o.vertexAttribDivisor(h+_,u.divisor);else if(16===u.count)for(var d=0;d<4;d++)s.vertexAttribPointer(h+d,4,u.type,u.normalized,u.stride,u.offset+16*d+f),s.enableVertexAttribArray(h+d),u.divisor>0&&o&&o.vertexAttribDivisor(h+d,u.divisor);else console.error("Unsupported vertex attribute element count: "+u.count)}}catch(g){c.e(g)}finally{c.f()}}function o(t,e,i,r){var a=t.gl,s=t.capabilities.instancing;t.bindBuffer(i);var o,l=Object(n.a)(r);try{for(l.s();!(o=l.n()).done;){var c=o.value,u=e.get(c.name);if(c.count<=4)a.disableVertexAttribArray(u),c.divisor&&c.divisor>0&&s&&s.vertexAttribDivisor(u,0);else if(9===c.count)for(var h=0;h<3;h++)a.disableVertexAttribArray(u+h),c.divisor&&c.divisor>0&&s&&s.vertexAttribDivisor(u+h,0);else if(16===c.count)for(var f=0;f<4;f++)a.disableVertexAttribArray(u+f),c.divisor&&c.divisor>0&&s&&s.vertexAttribDivisor(u+f,0);else console.error("Unsupported vertex attribute element count: "+c.count)}}catch(_){l.e(_)}finally{l.f()}t.unbindBuffer(34962)}function l(t){switch(t){case 6406:case 6409:case 36168:return 1;case 6410:case 32854:case 33325:case 32854:case 33189:return 2;case 6407:case 6402:return 3;case 6408:case 34041:case 33326:case 35898:case 33327:case 34041:return 4;case 33328:case 34842:return 8;case 34836:return 16;case 33776:case 33777:return.5;case 33778:case 33779:return 1;case 37488:case 37489:case 37492:case 37493:case 37494:case 37495:return.5;case 37490:case 37491:case 37496:case 37497:return 1}return 0}function c(t){if(Object(r.h)(t))return 0;if("descriptor"in t)return t.glName?c(t.descriptor):0;var e=t.internalFormat||"pixelFormat"in t&&t.pixelFormat;if(!e)return 0;var i="hasMipmap"in t&&t.hasMipmap?1.3:1,n=t.width*t.height;return l(e)*n*i}},753:function(t,e,i){"use strict";i.d(e,"a",(function(){return X})),i.d(e,"b",(function(){return u})),i.d(e,"c",(function(){return f})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return x})),i.d(e,"f",(function(){return o})),i.d(e,"g",(function(){return s}));var n=i(11),r=i(2),a=i(3);function s(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32774,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0,0];return{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function o(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:32774,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32774,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0,0,0];return{srcRgb:t,srcAlpha:e,dstRgb:i,dstAlpha:n,opRgb:r,opAlpha:a,color:{r:s[0],g:s[1],b:s[2],a:s[3]}}}var l={face:1029,mode:2305},c={face:1028,mode:2305},u=function(t){return 2===t?l:1===t?c:null},h={zNear:0,zFar:1},f={r:!0,g:!0,b:!0,a:!0};function _(t){return S.intern(t)}function d(t){return F.intern(t)}function g(t){return O.intern(t)}function v(t){return k.intern(t)}function p(t){return D.intern(t)}function m(t){return w.intern(t)}function b(t){return P.intern(t)}function T(t){return I.intern(t)}function x(t){return j.intern(t)}var E=function(){function t(e,i){Object(r.a)(this,t),this.makeKey=e,this.makeRef=i,this.interns=new Map}return Object(a.a)(t,[{key:"intern",value:function(t){if(!t)return null;var e=this.makeKey(t),i=this.interns;return i.has(e)||i.set(e,this.makeRef(t)),i.get(e)}}]),t}();function y(t){return"["+t.join(",")+"]"}var S=new E(A,(function(t){return Object(n.a)({__tag:"Blending"},t)}));function A(t){return t?y([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}var F=new E(R,(function(t){return Object(n.a)({__tag:"Culling"},t)}));function R(t){return t?y([t.face,t.mode]):null}var O=new E(C,(function(t){return Object(n.a)({__tag:"PolygonOffset"},t)}));function C(t){return t?y([t.factor,t.units]):null}var k=new E(M,(function(t){return Object(n.a)({__tag:"DepthTest"},t)}));function M(t){return t?y([t.func]):null}var D=new E(B,(function(t){return Object(n.a)({__tag:"StencilTest"},t)}));function B(t){return t?y([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}var w=new E(U,(function(t){return Object(n.a)({__tag:"DepthWrite"},t)}));function U(t){return t?y([t.zNear,t.zFar]):null}var P=new E(L,(function(t){return Object(n.a)({__tag:"ColorWrite"},t)}));function L(t){return t?y([t.r,t.g,t.b,t.a]):null}var I=new E(N,(function(t){return Object(n.a)({__tag:"StencilWrite"},t)}));function N(t){return t?y([t.mask]):null}var j=new E((function(t){return t?y([A(t.blending),R(t.culling),C(t.polygonOffset),M(t.depthTest),B(t.stencilTest),U(t.depthWrite),L(t.colorWrite),N(t.stencilWrite)]):null}),(function(t){return{blending:_(t.blending),culling:d(t.culling),polygonOffset:g(t.polygonOffset),depthTest:v(t.depthTest),stencilTest:p(t.stencilTest),depthWrite:m(t.depthWrite),colorWrite:b(t.colorWrite),stencilWrite:T(t.stencilWrite)}}));var X=function(){function t(e){Object(r.a)(this,t),this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=e}return Object(a.a)(t,[{key:"setPipeline",value:function(t){(this._pipelineInvalid||t!==this._pipeline)&&(this.setBlending(t.blending),this.setCulling(t.culling),this.setPolygonOffset(t.polygonOffset),this.setDepthTest(t.depthTest),this.setStencilTest(t.stencilTest),this.setDepthWrite(t.depthWrite),this.setColorWrite(t.colorWrite),this.setStencilWrite(t.stencilWrite),this._pipeline=t),this._pipelineInvalid=!1}},{key:"invalidateBlending",value:function(){this._blendingInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateCulling",value:function(){this._cullingInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidatePolygonOffset",value:function(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateDepthTest",value:function(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateStencilTest",value:function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateDepthWrite",value:function(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateColorWrite",value:function(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}},{key:"invalidateStencilWrite",value:function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}},{key:"setBlending",value:function(t){this._blending=this.setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}},{key:"setCulling",value:function(t){this._culling=this.setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}},{key:"setPolygonOffset",value:function(t){this._polygonOffset=this.setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}},{key:"setDepthTest",value:function(t){this._depthTest=this.setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}},{key:"setStencilTest",value:function(t){this._stencilTest=this.setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}},{key:"setDepthWrite",value:function(t){this._depthWrite=this.setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}},{key:"setColorWrite",value:function(t){this._colorWrite=this.setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}},{key:"setStencilWrite",value:function(t){this._stencilWrite=this.setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}},{key:"setSubState",value:function(t,e,i,n){return(i||t!==e)&&(n(t),this._pipelineInvalid=!0),t}}]),t}()},813:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(2),r=i(612),a=function t(e,i,r,a,s,o,l,c){Object(n.a)(this,t),this.createQuery=e,this.resultAvailable=i,this.getResult=r,this.disjoint=a,this.beginTimeElapsed=s,this.endTimeElapsed=o,this.createTimestamp=l,this.timestampBits=c};function s(t,e){if(e.disjointTimerQuery)return null;var i=t.getExtension("EXT_disjoint_timer_query_webgl2");return i&&Object(r.a)(t)?new a((function(){return t.createQuery()}),(function(e){return t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE)}),(function(e){return t.getQueryParameter(e,t.QUERY_RESULT)}),(function(){return t.getParameter(i.GPU_DISJOINT_EXT)}),(function(e){return t.beginQuery(i.TIME_ELAPSED_EXT,e)}),(function(){return t.endQuery(i.TIME_ELAPSED_EXT)}),(function(t){return i.queryCounterEXT(t,i.TIMESTAMP_EXT)}),(function(){return t.getQuery(i.TIMESTAMP_EXT,i.QUERY_COUNTER_BITS_EXT)})):(i=t.getExtension("EXT_disjoint_timer_query"))?new a((function(){return i.createQueryEXT()}),(function(t){return i.getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT)}),(function(t){return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)}),(function(){return t.getParameter(i.GPU_DISJOINT_EXT)}),(function(t){return i.beginQueryEXT(i.TIME_ELAPSED_EXT,t)}),(function(){return i.endQueryEXT(i.TIME_ELAPSED_EXT)}),(function(t){return i.queryCounterEXT(t,i.TIMESTAMP_EXT)}),(function(){return i.getQueryEXT(i.TIMESTAMP_EXT,i.QUERY_COUNTER_BITS_EXT)})):null}}}]);
//# sourceMappingURL=1.e0061fbe.chunk.js.map